// src/data/notes.js
// ä¾åˆ†å€ï¼šschool-curriculum / coding-practice / other-practice
export const NOTES = [
  // *******************************************************************
    // *******************************************************************
      // *******************************************************************

  {
    id: "n-114-grad-csie",
    slug: "114-csie-grad-admission",
    title: "114 è³‡å·¥ç ”ç©¶æ‰€æ¨ç”„",
    date: "2024-11-03",
    category: "other-practice",
    tags: ["æ¨ç”„", "è³‡å·¥", "ç ”ç©¶æ‰€", "é¢è©¦", "å‚™å¯©", "å¿ƒå¾—", "å‡å­¸"],
    cover: `${process.env.PUBLIC_URL}/coding.gif`,
    summary:
      "å®Œæ•´æ•´ç† 114 å¹´è³‡å·¥æ‰€æ¨ç”„ç¶“é©—ï¼šèƒŒæ™¯æˆç¸¾ã€ç«¶è³½èˆ‡çé …ã€å„æ ¡åé¡/å ±åæ•¸èˆ‡éŒ„å–ç‡ã€113/114 å ±åè®ŠåŒ–èˆ‡çµæœã€å„æ ¡æ›¸å¯©é‡é»ã€ä¸­å¤®é¢è©¦æµç¨‹èˆ‡ Q&Aã€è¸©é›·èˆ‡æ•´é«”çµè«–ï¼Œä¸¦é™„åƒè€ƒé€£çµã€‚",
    content: `
# 114 è³‡å·¥ç ”ç©¶æ‰€æ¨ç”„

> æœ¬æ–‡ç‚º 114 å¹´åº¦è³‡å·¥æ‰€æ¨ç”„å…¨ç´€éŒ„èˆ‡å¿ƒå¾—ï¼ŒåŒ…æ‹¬èƒŒæ™¯ã€å„æ ¡æ›¸å¯©é‡é»ã€é¢è©¦æµç¨‹èˆ‡æå•ã€è¸©é›·æ¸…å–®ã€ä»¥åŠæœ€çµ‚ç¸½çµã€‚  
> åŸæ–‡å‡ºè™•ï¼š[Notion cyc](https://www.notion.so/114-11cc0d33e7e5809db939f35622584160)

---

## ğŸ”´ èƒŒæ™¯

åœ‹ç«‹é«˜é›„ç§‘æŠ€å¤§å­¸ [é›»è…¦èˆ‡é€šè¨Šå·¥ç¨‹ç³»](https://www.bing.com/ck/a?!&&p=437fd80a22874e32cdf6524a273f15275e26cc751df24d5ed74857e0bba81e67JmltdHM9MTczMjQwNjQwMA&ptn=3&ver=2&hsh=4&fclid=2747ea49-5889-6096-3d31-fe1c59996115&psq=%e9%ab%98%e7%a7%91%e9%9b%bb%e9%80%9a%e7%b3%bb&u=a1aHR0cHM6Ly9jY2VlLm5rdXN0LmVkdS50dy8&ntb=1)

### åœ¨æ ¡æˆç¸¾

| é …ç›® | æˆç¸¾ |
| --- | --- |
| ç­æ’å | 3%ï¼ˆ2/58ï¼‰ |
| ç³»æ’å | 5%ï¼ˆ6/116ï¼‰ |
| å­¸æ¥­ç¸½å¹³å‡ | 91.81 |
| æ›¸å·ç | 4 |

### ç«¶è³½èˆ‡å¾—çç¶“æ­·

| å¹´åº¦ | ç¶“æ­· |
| --- | --- |
| 113 | [**è³‡è¨Šæ‡‰ç”¨æœå‹™å‰µæ–°ç«¶è³½**](https://www.bing.com/ck/a?!&&p=1bf865a6940f3618a9ecf70df34d1b3841f8469244d12d9b2edc8ab7322205fcJmltdHM9MTczMjQwNjQwMA&ptn=3&ver=2&hsh=4&fclid=2747ea49-5889-6096-3d31-fe1c59996115&psq=%e8%b3%87%e6%9c%8d%e7%ab%b6%e8%b3%bd&u=a1aHR0cHM6Ly9pbm5vc2VydmUudGNhLm9yZy50dy8&ntb=1) æ•™è‚² AI çµ„ä½³ä½œã€AI å·¥å…·æ‡‰ç”¨çµ„ç¬¬äºŒå |
| 113 | é€šé [**åœ‹å®¶ç§‘å­¸åŠæŠ€è¡“å§”å“¡æœƒå¤§å°ˆå­¸ç”Ÿç ”ç©¶è¨ˆç•«**](https://www.bing.com/ck/a?!&&p=f6220b845d29749ccfacb51f92b26671436bc10ccbaac3007082a2af77ef4759JmltdHM9MTczMjQwNjQwMA&ptn=3&ver=2&hsh=4&fclid=2747ea49-5889-6096-3d31-fe1c59996115&psq=%e5%9c%8b%e7%a7%91%e6%9c%83%e5%a4%a7%e5%b0%88%e7%94%9f%e7%a0%94%e7%a9%b6%e8%a8%88%e7%95%ab&u=a1aHR0cHM6Ly93d3cubnN0Yy5nb3YudHcvZm9sa3Nvbm9teS9saXN0LzJhZjlhZDlhLTFmNDctNDUwZC1iNWExLTJjYjQzZGU4MjkwYz92aWV3TW9kZT1saXN0VmlldyZsPWNo&ntb=1) |
| 113 | [**åœ‹ç«‹é«˜é›„ç§‘æŠ€å¤§å­¸é›»æ©Ÿèˆ‡è³‡è¨Šå­¸é™¢**](https://www.bing.com/ck/a?!&&p=8d1dbefb0902660b8341ed8ef8c1bcd28f1d7f51f2800db054b62ab12d904282JmltdHM9MTczMjQwNjQwMA&ptn=3&ver=2&hsh=4&fclid=2747ea49-5889-6096-3d31-fe1c59996115&psq=%e9%ab%98%e7%a7%91%e5%a4%a7%e9%9b%bb%e8%b3%87%e5%ad%b8%e9%99%a2&u=a1aHR0cHM6Ly9jZWVjcy5ua3VzdC5lZHUudHcv&ntb=1) å°ˆé¡Œç‰¹å„ª |
| 113 | å…¨åœ‹ç§‘æŠ€å¤§å°ˆæ ¡é™¢ç¨‹å¼ç«¶è³½ éŠ…ç |
| 113 | é›»è…¦èˆ‡é€šè¨Šå·¥ç¨‹ç³» å°ˆé¡Œç¬¬äºŒå |
| 113 | å¤§å°ˆç”Ÿæš‘æœŸå·¥è®€ ç†±å¿ƒæœå‹™ç |
| 113 | åœ‹ç«‹é«˜é›„ç§‘æŠ€å¤§å­¸ æ ¡åœ’å‰µæ„ç™¼æƒ³ç«¶è³½ å„ªç­‰ |
| 113 | æ–‡å‘æ•™è‚²åŸºé‡‘æœƒ çå­¸é‡‘ |
| 112 | å…¨åœ‹ç§‘æŠ€å¤§å°ˆæ ¡é™¢ç¨‹å¼ç«¶è³½ éŠ€ç |
| 112 | [æ•™è‚²å¤§æ•¸æ“šåˆ†æç«¶è³½](https://www.bing.com/ck/a?!&&p=9b5609a513d215ed45092ff7e531d93ab91c3372538bd7b728eb3c409b457756JmltdHM9MTczMjQwNjQwMA&ptn=3&ver=2&hsh=4&fclid=2747ea49-5889-6096-3d31-fe1c59996115&psq=%e6%95%99%e8%82%b2%e5%a4%a7%e6%95%b8%e6%93%9a%e7%ab%b6%e8%b3%bd&u=a1aHR0cHM6Ly9wYWRzLm1vZS5lZHUudHcvcGFkc19mcm9udC9pbmRleC5waHA_YWN0aW9uPXBhZ2VzMS1uZXctY29tcGV0aXRpb24&ntb=1) æ±ºè³½ |
| 112 | æ ¡å…§æ•™å­¸åŠ©ç† è¡¨ç¾å„ªç•°ç |
| 112 | [ICPC åœ‹éš›å¤§å­¸ç”Ÿç¨‹å¼ç«¶è³½](https://www.bing.com/ck/a?!&&p=4ca7372abd32ab431d0af3debf72ea61d69909d6287dbd5649d5b877f0b55aa7JmltdHM9MTczMjQwNjQwMA&ptn=3&ver=2&hsh=4&fclid=2747ea49-5889-6096-3d31-fe1c59996115&psq=icpc&u=a1aHR0cHM6Ly9pY3BjLmdsb2JhbC8&ntb=1) |
| 112 | [å¤§å­¸ç”Ÿç¨‹å¼èƒ½åŠ›æª¢å®šï¼ˆCPEï¼‰](https://www.bing.com/ck/a?!&&p=7c10a3516ea6fcc29442bee6506f4e76ec2566d52bbf1aa72fd2b3617f6380a2JmltdHM9MTczMjQwNjQwMA&ptn=3&ver=2&hsh=4&fclid=2747ea49-5889-6096-3d31-fe1c59996115&psq=CPE&u=a1aHR0cHM6Ly9jcGUuY3NlLm5zeXN1LmVkdS50dy8&ntb=1) å››é¡Œ |
| 112 | æ–‡å‘æ•™è‚²åŸºé‡‘æœƒ çå­¸é‡‘ |

---

## ğŸŸ  æ¨ç”„ç³»æ‰€

| å­¸æ ¡ | ç³»æ‰€ | æ‹›æ”¶äººæ•¸ | å ±åäººæ•¸ | éŒ„å–ç‡ |
| --- | --- | ---: | ---: | ---: |
| äº¤å¤§ | é›»ä¿¡ç”²çµ„ | 45 | 344 | 13.08% |
| äº¤å¤§ | æ•¸æ“š | 39 | 484 | 8.05% |
| æˆå¤§ | è³‡å·¥ç”² | 87 | 629 | 13.83% |
| äº¤å¤§ | æ™ºèƒ½ï¼ˆè¯æ‹›ï¼‰ | ç”²15 / ä¹™5 / ä¸™9 / ä¸11 | 610 | 6.55% |
| ä¸­å¤® | è³‡å·¥ | 90 | 596 | 15.10% |
| äº¤å¤§ï¼ˆå°å—ï¼‰ | æ™ºæ…§ç§‘å­¸ï¼ˆè¯æ‹›ï¼‰ | ç”²12 / ä¹™9 / ä¸™9 | 274 | 10.94% |
| ä¸­å±± | è³‡å·¥ | 54 | 390 | 13.84% |
| ä¸­æ­£ | è³‡å·¥ | 83 | 541 | 15.34% |

---

## ğŸŸ¡ 113 å’Œ 114 å ±åäººæ•¸èˆ‡æ¨ç”„çµæœ

> ç´…è‰²ï¼šå ±åäººæ•¸**å¢åŠ ** æˆ– **è½æ¦œ**ã€‚  
> ç¶ è‰²ï¼šå ±åäººæ•¸**æ¸›å°‘** æˆ– **ä¸Šå²¸**ã€‚

| å­¸æ ¡ | ç³»æ‰€ | 114 å ±å | 113 å ±å | ä¸€éšåˆ†æ•¸ | äºŒéšåˆ†æ•¸ | çµæœ |
| --- | --- | ---: | ---: | --- | --- | --- |
| äº¤å¤§ | é›»ä¿¡ç”² | **344** | 339 | â€” | â€” | **è½æ¦œ** |
| äº¤å¤§ | æ•¸æ“š | **484** | 441 | â€” | â€” | **å‚™å– 33** |
| æˆå¤§ | è³‡å·¥ç”² | **629** | 570 | 39.19 | ä¸€éšæœªé€šé | **è½æ¦œ** |
| äº¤å¤§ | æ™ºèƒ½ | **610** | 443 | â€” | â€” | è½æ¦œï¼›å‚™å– 144ï¼›â€”ï¼›è½æ¦œ |
| ä¸­å¤® | è³‡å·¥ | 596 | **604** | 85.72 | 87.68 | **å‚™å– 61** |
| äº¤å¤§ï¼ˆå°å—ï¼‰ | æ™ºæ…§ç§‘å­¸ | **274** | 251 | â€” | â€” | å‚™å– 23ï¼›å‚™å– 14ï¼›å‚™å– 7 |
| ä¸­å±± | è³‡å·¥ | **390** | 420 | é€šé | æ”¾æ£„ï¼ˆæ’ä¸­å¤®ï¼‰ | é€²äºŒéšï¼Œæ”¾æ£„ |
| ä¸­æ­£ | è³‡å·¥ | **541** | 518 | 89.6 | æ”¾æ£„é¢è©¦ | é€²äºŒéšï¼Œæ”¾æ£„ |

---

## ğŸŸ¢ æ›¸å¯©

### äº¤å¤§

- [æ•¸æ“šå·¥ç¨‹](https://www.bing.com/ck/a?!&&p=525e62ed23e02eee15851d85c75b13ee32e11668fca3eba99d61dde39bf6cecbJmltdHM9MTczMjQwNjQwMA&ptn=3&ver=2&hsh=4&fclid=2747ea49-5889-6096-3d31-fe1c59996115&psq=%e4%ba%a4%e5%a4%a7%e6%95%b8%e6%93%9a&u=a1aHR0cHM6Ly93d3cuY3MubnljdS5lZHUudHcvaW50cm8vb3JnYW5pemF0aW9uL2RhdGE&ntb=1)  
  ä¸»è¦åˆ°è³‡å·¥æ‰€ç¶²ç«™å¡«è¡¨å–®ï¼›[**é™½æ˜äº¤é€šå¤§å­¸æ‹›ç”Ÿç¶²ç«™**](https://www.bing.com/ck/a?!&&p=c974ddd94f12c9b32ab934727fc849f402fc49e97ce269bd1c0a2ce77df290b4JmltdHM9MTczMjQwNjQwMA&ptn=3&ver=2&hsh=4&fclid=2747ea49-5889-6096-3d31-fe1c59996115&psq=%e4%ba%a4%e5%a4%a7%e7%94%84%e8%a9%a6&u=a1aHR0cHM6Ly9leGFtLm55Y3UuZWR1LnR3Lw&ntb=1) éœ€å¡«ï¼šè€ƒç”Ÿè³‡æ–™è¡¨ã€æˆç¸¾å–®ã€åœ¨å­¸è­‰æ˜ã€‚  
  ç³»æ‰€ç¶²ç«™éœ€å¡«ï¼šåœ¨æ ¡æˆç¸¾ï¼ˆç­/ç³»æ’ã€å„å­¸æœŸã€ä¿®èª²è¡¨ç¾ï¼‰ã€**å°ˆé¡Œ/ç«¶è³½/è¨ˆç•«**ï¼ˆPDFï¼‹æ•™æˆç°½åè²¢ç»è­‰æ˜ï¼‰ã€**CPE**ï¼ˆè­‰æ˜èˆ‡è©•ç´šï¼‰ã€‚

- [é›»ä¿¡ç”²çµ„](https://www.bing.com/ck/a?!&&p=03f8ef49b08194390239c53dfef839fedf6021a4f51756f283d0fa679e98ad57JmltdHM9MTczMjQwNjQwMA&ptn=3&ver=2&hsh=4&fclid=2747ea49-5889-6096-3d31-fe1c59996115&psq=%e4%ba%a4%e5%a4%a7%e9%9b%bb%e4%bf%a1&u=a1aHR0cHM6Ly9jbS5ueWN1LmVkdS50dy8&ntb=1)  
  ç³»ç¶²ï¼‹æ‹›ç”Ÿç¶²ç«™çš†é ˆå¡«ã€‚**çµè«–**ï¼šé€£å‚™å–ç„¡ï¼Œç•¥ã€‚

**çµè«–**ï¼šæ•¸æ“šæ‰€è¡¨å–®æ¬„ä½å¤šä¸”ç´°ï¼Œç«¶è³½é–€æª»åé«˜ï¼ˆå¦‚ ICPCã€ç©é«”é›»è·¯ç«¶è³½ç­‰ï¼‰ï¼Œ**èƒ½å¡«ç›¡é‡å¡«**ã€‚

### æˆå¤§ï¼ˆè³‡å·¥ç”²ï¼‰

- [ç³»ç¶²](https://www.csie.ncku.edu.tw/zh-hant/ncku_csie/) éœ€å¡« **Google è¡¨å–®**ï¼›[æˆå¤§æ‹›ç”Ÿç¶²ç«™](https://campus4.ncku.edu.tw/wwwmenu/program/net/new/net1/login.php) ç¨ç«‹ç¹³ä»¶ã€‚  
- Google è¡¨å–®ï¼šåœ¨æ ¡æˆç¸¾ï¼ˆç­/ç³»æ’ã€%ï¼‰ã€**è³‡å·¥å…­ç§‘æˆç¸¾**ã€ç¶“æ­·ã€**GitHub** é€£çµã€‚  
- æ‹›ç”Ÿç¶²ç«™ï¼šå€‹äººå¯©æŸ¥è³‡æ–™è¡¨ã€æˆç¸¾å–®ã€è®€æ›¸è¨ˆç•«ã€å°ˆé¡Œèˆ‡ç ”ç©¶èƒ½åŠ›ã€è³‡è¨Šèƒ½åŠ›è­‰æ˜ã€‚  

**çµè«–**ï¼šä¸€éšç´„å·® 1.x æœªé€²é¢è©¦ï¼ˆç•¶æ™‚ **GitHub æ¬„ä½æœªæ”¾é€£çµ**ï¼‰ã€‚ç³»çµ±æœƒ**è‡ªå‹•åˆä½µ**ç¹³äº¤æª”æ¡ˆï¼Œå°é¢/ç›®éŒ„éœ€ç‰¹åˆ¥å°å¿ƒã€‚

### ä¸­å¤®ï¼ˆè³‡å·¥ï¼‰

- [ç³»ç¶²](https://www.csie.ncu.edu.tw/)  
- ä¸€ä»½å‚™å¯©ï¼š  
  A. å°ˆé¡Œç ”ç©¶å ±å‘Šã€B. å­¸è¡“è«–æ–‡ï¼ˆå¯å…ï¼‰ã€C. ç ”ç©¶/è®€æ›¸è¨ˆç•«èˆ‡è‡ªå‚³ï¼ˆA+B+C **ç¸½å­—æ•¸ â‰¤ 2000**ï¼‰ã€‚  
- å…¶ä»–ï¼šç«¶è³½/æ´»å‹•è­‰æ˜ã€**å…©å°ç·šä¸Šæ¨è–¦ä¿¡**ã€‚

**çµè«–**ï¼šå¯¦éš›ç¹³äº¤ **> 5000 å­—** ä»å£“ç·šé€²é¢è©¦ï¼Œä¸ç¢ºå®šé•åå­—æ•¸æ˜¯å¦å½±éŸ¿åˆ†æ•¸ã€‚

### ä¸­å±±ï¼ˆè³‡å·¥ï¼‰

- [ç³»ç¶²](https://cse.nsysu.edu.tw/)  
- é¡ä¼¼æˆå¤§ï¼Œ**åˆ†æª”ä¸Šå‚³**ã€‚  
**çµè«–**ï¼šç…§ç‰‡éœ€ç¬¦åˆè¦æ ¼ï¼Œæ¨¡ç³Šæœƒè¢«è¦æ±‚æ›´æ›ã€‚

### ä¸­æ­£ï¼ˆè³‡å·¥ï¼‰

- [ç³»ç¶²](https://cs.ccu.edu.tw/)  
- å°è±¡åƒ…éœ€ **å–®ä¸€æª”æ¡ˆ**ã€‚  
**çµè«–**ï¼šç³»çµ±ä¸æ”¯æ´ PDF **è·³é é€£çµ**ï¼Œä¸Šå‚³æœƒå¤±æ•—ï¼ˆç•¶æ™‚æœ‰è‡´é›»è©¢å•ï¼‰ã€‚

---

## ğŸ”µ é¢è©¦ï¼ˆä¸­å¤®ï¼‰

- **å®˜æ–¹å…¬å‘Š**ï¼ˆPDFï¼‰ï¼š[å…¬å‘Š - åœ‹ç«‹ä¸­å¤®å¤§å­¸è³‡è¨Šå·¥ç¨‹å­¸ç³».pdf](https://prod-files-secure.s3.us-west-2.amazonaws.com/d62c8dde-c6c2-4dc2-9637-f498e43cfe2f/6b49e112-dc1e-484c-954e-de79ea1f8c05/%E5%85%AC%E5%91%8A_-_%E5%9C%8B%E7%AB%8B%E4%B8%AD%E5%A4%AE%E5%A4%A7%E5%AD%B8%E8%B3%87%E8%A8%8A%E5%B7%A5%E7%A8%8B%E5%AD%B8%E7%B3%BB.pdf)

**æµç¨‹**  
- 3 åˆ†é˜ç°¡å ±ï¼ˆPPT æˆ– PDFï¼‰ï¼‹ 3 åˆ†é˜æ•™æˆæå•ã€‚  
- æˆåŠŸå ±åˆ°å¾Œåœ¨ç­‰å€™å€ç­‰å¾…ï¼›å·¥ä½œäººå“¡æŒ‰åºå«è™Ÿï¼ˆ**äº”äººä¸€çµ„**ï¼‰ï¼Œå¼•å°è‡³æœƒè­°å®¤å¤–ç­‰å€™ï¼Œä¾åºé€²å ´ã€‚  
- ç¾å ´**æä¾›ç­†é›»èˆ‡ç°¡å ±ç­†**ã€‚  

**é¢è©¦ç°¡å ±**ï¼ˆé«”æ„Ÿç´„ 3 åˆ†é˜ï¼‰  
- ç­–ç•¥ï¼šé‡å¿ƒæ”¾åœ¨**ç¶“æ­·**ï¼ˆæˆç¸¾ã€ç«¶è³½ã€å°ˆé¡Œ/è¨ˆç•«ï¼‰ï¼Œ**å…± 8 é **ã€‚å¹³æ™‚æ¼”ç·´ç´„ **2:40**ã€‚  

**æ•™æˆæå•**ï¼ˆé«”æ„Ÿç´„ 2 åˆ†é˜ï¼‰  
- **Qï¼ˆæ•™æˆ Aï¼‰**ï¼šä½ çš„ä¸»è¦è¡¨ç¾æ˜¯ XXX æ¯”è³½å—ï¼Ÿç‚ºä»€éº¼è¦æ‰“ ğŸŒŸï¼Ÿ  
  **A**ï¼šåŸå…ˆä»£è¡¨æ¯”è³½ä»åœ¨é€²è¡Œï¼Œå› é¢±é¢¨å»¶æœŸï¼Œé¢è©¦æ™‚æ¯”è³½å·²çµæŸä¸¦ç²ä½³ä½œèˆ‡ç¬¬äºŒåï¼ˆè³‡æœç«¶è³½ï¼‰ã€‚  
- **Qï¼ˆæ•™æˆ Bï¼‰**ï¼šä½ åœ‹ç§‘æœƒè¨ˆç•«çš„è³‡æ–™æ€éº¼ä¾†ï¼Ÿæœ‰èˆ‡å–®ä½åˆä½œå—ï¼Ÿ  
  **A**ï¼šä½¿ç”¨é«˜é›„æŸç¶œåˆé†«é™¢æä¾›çš„çœŸå¯¦æ•¸æ“šã€‚  
- **Qï¼ˆæ•™æˆ Bï¼‰**ï¼šè³‡æ–™å¦‚ä½•è¡¨ç¤ºï¼Ÿ  
  **A**ï¼šåŒ…å«æ‰‹è¡“åç¨±ã€éº»é†‰è—¥ç‰©ã€é†«å¸«å§“åèˆ‡å¹´è³‡ç­‰æ¬„ä½ï¼Œé€éâ€¦â€¦ï¼ˆç•¥ï¼‰ï¼Œå› æ­¤èƒ½åšå‡ºç¬¦åˆçœŸå¯¦çš„é æ¸¬ã€‚  
- **Qï¼ˆæ•™æˆ Cï¼‰**ï¼šCPE å°ˆæ¥­ç´šå¹¾é¡Œï¼Ÿ  
  **A**ï¼š4 é¡Œã€‚  

**å°çµ**  
- é¢è©¦æ™‚é–“åœ¨å‚æ™šï¼Œæå•åè¡¨é¢ï¼›ä¿æŒç©©å®šå¿ƒæ…‹èˆ‡æ¢ç†æ¸…æ¥šçš„èªªæ˜å³å¯ã€‚  
- ç ”ç©¶èˆ‡ä¿®èª²è¨ˆç•«**åˆä½µä¸€é **å‘ˆç¾ï¼›å°ˆé¡Œèˆ‡åœ‹ç§‘æœƒè¨ˆç•«ä»¥**æ¦‚è¦**ç‚ºä¸»ã€‚

---

## ğŸŸ£ ç¸½çµ

### æ¨ç”„æœŸé–“é‡åˆ°çš„å¹¾å€‹å•é¡Œ
- ä¸ç†Ÿæ‚‰**æˆå¤§**åˆä½µæ©Ÿåˆ¶ â†’ å‡ºç¾**å¤šå°é¢/å¤šå°åº•**ã€‚  
- æˆå¤§è³‡å·¥ **Google è¡¨å–®**é ˆå¡« **GitHub**ï¼Œéœ€æå‰æ•´ç†ã€‚  
- **ä¸­å¤®äºŒéš**å› é¢±é¢¨å»¶æœŸèˆ‡**ä¸­å±±äºŒéš**æ’æœŸï¼Œå…©è€…çš†åœ¨ä¸‹åˆï¼Œ**åªèƒ½æ“‡ä¸€**ã€‚  
- **äº¤å¤§æ™ºèƒ½æ‰€**å°é¢åœ–èª¤æ”¾ä¸­å¤®è³‡å·¥ç³»é¤¨ã€‚  

### æ¥­ç¸¾é‡è¦åº¦ï¼ˆå€‹äººé«”æ„Ÿï¼‰
1. **æ’å**ï¼šç³»æ’èˆ‡ç­æ’  
2. **è³‡å·¥ä¿®èª²æˆç¸¾**ï¼šæ ¸å¿ƒå¿…ä¿®ä¸å¯è½  
3. **è¨ˆç•«èˆ‡å°ˆæ¡ˆ**ï¼šæ”¿åºœè¨ˆç•«ã€ä¼æ¥­/ç”¢å­¸åˆä½œ  
4. **ç¨‹å¼æª¢å®š/æ¯”è³½**ï¼šCPEã€ICPCã€Codeforcesã€LeetCode  

**çµè«–**ï¼š**æ’å > ä¿®èª²æˆç¸¾ > è¨ˆç•«å°ˆæ¡ˆ â‰¥ ç¨‹å¼æª¢å®š â‰¥ å…¶ä»–**ï¼ˆåŠ©æ•™ã€æ ¡å…§çç­‰ï¼‰ã€‚

---

## âš« é™„éŒ„ï¼ˆåƒè€ƒæ–‡ç»ï¼‰
- [è³‡å·¥æ¨ç”„çµæœä¸²](https://csie-apply-result.de.r.appspot.com/)  
- [[å¿ƒå¾—] 111å¹´åº¦ è³‡å·¥æ‰€æ¨ç”„ - HackMD](https://hackmd.io/@BeNordic/rk6XEtjDY)  
- [112 ç ”ç©¶æ‰€æ¨ç”„å¿ƒå¾— - HackMD](https://hackmd.io/@j1v4rpJsSuu3wxkb-2W5Fg/H1KUGQiLo)  
- [113 å¹´è³‡å·¥æ‰€æ¨ç”„å¿ƒå¾— - HackMD](https://hackmd.io/@daaaaaaaavid/H1rwo6Kw6)  
- [114 è³‡å·¥æ‰€æ¨ç”„å¿ƒå¾—åˆ†äº« - HackMD](https://hackmd.io/@pinhsiu92/HJQkYvWsq)  
- [[ç ”ç©¶æ‰€æ¨ç”„å¿ƒå¾—] 2022 è³‡å·¥æ‰€ - Medium](https://medium.com/@ycpin/%E5%BF%83%E5%BE%97-2022-%E8%B3%87%E5%B7%A5%E6%89%80%E6%8E%A8%E7%94%84-51f93baa3244)  
- [[ç ”ç©¶æ‰€æ¨ç”„] è³‡å·¥æ‰€æ¨ç”„å¿ƒå¾—1 - MeetonFriday](https://meetonfriday.com/posts/44bbe391/)  
- [[å¿ƒå¾—] 111 è³‡å·¥æ‰€æ¨ç”„å¿ƒå¾— - PTT](https://www.ptt.cc/bbs/graduate/M.1641911922.A.05E.html)
`
  },
  // *******************************************************************
  {
  id: "n-nycu-dl-2025",
  slug: "nycu-deep-learning-2025",
  title: "NYCU Deep Learning (Summer 2025)",
  date: "2025-07-01",
  category: "school-curriculum",            
  cover: `${process.env.PUBLIC_URL}/DL.png`,
  tags: ["Deep Learning","NYCU","Course","Labs","Reinforcement Learning","Diffusion"],
  // cover å¯ç•™ç©ºï¼Œæ²’æœ‰å°±æœƒèµ°ä½ å¡ç‰‡çš„æ¼¸å±¤é è¨­
  summary:
    "NYCU è³‡å·¥æš‘æœŸ Deep Learning èª²ç¨‹ï¼šä¸»é¡Œã€è©•åˆ†ã€æ™‚ç¨‹ã€åƒè€ƒæ›¸èˆ‡å¯¦ä½œå€‰åº«ã€‚å« Labsã€è«–æ–‡å ±å‘Šèˆ‡æœŸæœ«å°ˆé¡Œã€‚",
  content: `
# NYCU Deep Learning (Summer 2025)
> National Yang Ming Chiao Tung University â€” Department of Computer Science

**GitHub Repo**ï¼š<https://github.com/solar224/NYCU_DL>

[![Course](https://img.shields.io/badge/Course-Deep%20Learning-blue)]()
[![Semester](https://img.shields.io/badge/Semester-Summer%202025-informational)]()
[![Language](https://img.shields.io/badge/Language-English-lightgrey)]()

---

## Table of Contents
- [Overview](#èª²ç¨‹ç°¡ä»‹-overview)
- [Instructors](#æˆèª²æ•™å¸«èˆ‡åŠ©æ•™-instructors--tas)
- [Grading](#è©•åˆ†æ–¹å¼-grading)
- [Schedule](#æ™‚ç¨‹èˆ‡ä¸»é¡Œ-schedule)
- [Textbooks & References](#æ•™æèˆ‡åƒè€ƒ-textbooks--references)
- [Repo Structure](#å°ˆæ¡ˆå€‰åº«å»ºè­°çµæ§‹-suggested-repo-structure)

---

## èª²ç¨‹ç°¡ä»‹
æœ¬èª²ç¨‹å…¼é¡§ **ç†è«–** èˆ‡ **å¯¦ä½œ**ï¼Œå…§å®¹æ¶µè“‹ï¼š
- æ·±å±¤å‰é¥‹ç¶²è·¯ã€CNNã€RNN/Recursive nets  
- Autoencodersã€Linear factor modelsã€GANsã€Normalizing flowsã€Diffusion  
- å¼·åŒ–å­¸ç¿’ï¼ˆå€¼å‡½æ•¸ã€æ”¿ç­–ã€æ¨¡å‹å¼ï¼‰  
- æœŸæœ«ä»¥**è«–æ–‡é¢¨æ ¼**ç™¼è¡¨å°ˆé¡Œ

---

## æˆèª²æ•™å¸«
- å½­æ–‡å­ï¼ˆPengï¼‰ï½œwpeng@cs.nctu.edu.tw  
- é™³æ°¸æ˜‡ï¼ˆChenï¼‰ï½œyschen@nycu.edu.tw  
- è¬ç§‰å‡ï¼ˆHsiehï¼‰ï½œpinghsieh@cs.nycu.edu.tw  

---

## è©•åˆ†æ–¹å¼ 
**Part Iï¼ˆ3 å­¸åˆ†ï¼‰Deep Learning**
- 4 Labsï¼ˆLab 0ã€2ã€5ã€6ï¼›å€‹åˆ¥å®Œæˆï¼‰80%
- æœŸæœ«è€ƒ 20%

**Part IIï¼ˆ3 å­¸åˆ†ï¼‰Deep Learning & Practice**
- 4 Labsï¼ˆLab 1ã€3ã€4ã€7ï¼‰50%
- è«–æ–‡å ±å‘Šï¼ˆ3 äººä¸€çµ„ï¼‰25%
- æœŸæœ«å°ˆé¡Œï¼ˆ3 äººä¸€çµ„ï¼‰25%

---

## æ™‚ç¨‹èˆ‡ä¸»é¡Œ
> Afternoon ç‚ºä¸‹åˆèª²ï¼›Evening ç‚ºæ™šé–“å¯¦ä½œï¼å¯¦é©—èª²ã€‚Dates in **2025/7â€“8**.

| Date | Afternoon Topic                           | Evening / Lab                     |
|-----:|-------------------------------------------|-----------------------------------|
| 7/1  | Introduction & ML Basics                  | Warm-up (**Lab 0**)               |
| 7/3  | Deep Feedforward Networks                 | Back-Propagation (**Lab 1**)      |
| 7/8  | Convolutional Networks                    | ConvNets & Transformers (**Lab 2**) |
| 7/10 | Introduction to Reinforcement Learning    | No class                          |
| 7/15 | Recurrent & Recursive Nets                | MaskGIT (**Lab 3**)               |
| 7/17 | Linear Factor Models, Autoencoders        | No class                          |
| 7/22 | Generative Adversarial Networks           | CVAE (**Lab 4**)                  |
| 7/24 | Value-Based Reinforcement Learning        | No class                          |
| 7/29 | Policy-Based Reinforcement Learning       | Discrete Control (**Lab 5**)      |
| 7/31 | Diffusion Models                          | No class                          |
| 8/5  | Normalizing Flows                         | Diffusion (**Lab 6**)             |
| 8/7  | Final Project Proposal                    | Final Project Proposal            |
| 8/12 | Model-Based Reinforcement Learning        | Continuous Control (**Lab 7**)    |
| 8/14 | No class                                  | No class                          |
| 8/19 | Paper Presentation                        | Paper Presentation                |
| 8/21 | Paper Presentation                        | Paper Presentation                |
| 8/26 | Final Exam                                | â€”                                 |
| 8/28 | Final Project Demo                        | â€”                                 |

---

## æ•™æèˆ‡åƒè€ƒ
- I. Goodfellow, Y. Bengio, A. Courville, *Deep Learning*, MIT Press, 2016.  
- R. S. Sutton, A. G. Barto, *Reinforcement Learning: An Introduction*, 2020.  
- èª²ç¨‹ææ–™ç´„è‡ªç·¨èˆ‡æ—¢æœ‰æ•™æå„ä½” 50%ï¼ˆfor reference onlyï¼‰

---

## å°ˆæ¡ˆå€‰åº«çµæ§‹
~~~text
.
â”œâ”€â”€ labs/
â”‚   â”œâ”€â”€ lab0_warmup/
â”‚   â”œâ”€â”€ lab1_backprop/
â”‚   â”œâ”€â”€ lab2_conv_transformers/
â”‚   â”œâ”€â”€ lab3_maskgit/
â”‚   â”œâ”€â”€ lab4_cvae/
â”‚   â”œâ”€â”€ lab5_discrete_rl/
â”‚   â”œâ”€â”€ lab6_diffusion/
â”‚   â””â”€â”€ lab7_continuous_rl/
â”œâ”€â”€ paper_presentation/
â”‚   â”œâ”€â”€ slides/
â”‚   â””â”€â”€ report/
â”œâ”€â”€ final_project/
â”‚   â”œâ”€â”€ proposal/
â”‚   â”œâ”€â”€ code/
â”‚   â””â”€â”€ paper/
â”œâ”€â”€ docs/              # notes, additional references
â”œâ”€â”€ .gitignore
â””â”€â”€ README.md
~~~
`
},
// *******************************************************************
  // *******************************************************************
    // *******************************************************************

{
    id: "n-free5gc-lab0",
    slug: "free5gc-lab0-network-programming-basics",
    title: "free5GC Lab0ï¼šç¶²è·¯ç¨‹å¼è¨­è¨ˆçš„åŸºç¤ï¼ˆGo/TCP Echoï¼‰",
    date: "2025-09-06",
    category: "school-curriculum",
    tags: ["free5GC", "5G", "Networking", "Go", "TCP", "Goroutine", "Lab0"],
    cover: `${process.env.PUBLIC_URL}/free5gc.png`, // æœ‰åœ–å°±æ‰“é–‹ï¼›æ²’åœ–å¯ç•™ç©ºèµ°é è¨­
    summary:
      "ç”¨ Go çš„ net å¥—ä»¶å¯¦ä½œ TCP Echo ä¼ºæœå™¨ï¼šClient-Server æ¨¡å‹ã€goroutine ä½µç™¼ã€è³‡æºé‡‹æ”¾èˆ‡ go test/-race é©—è­‰ï¼Œæ”¯æ´å¤šé€£ç·šèˆ‡æ­£ç¢ºå›æ‡‰ã€‚",
    content: `
# free5GC Lab

GitHub Repoï¼š[free5GLab](https://github.com/free5gc/free5GLabs)

# Lab0 ç¶²è·¯ç¨‹å¼è¨­è¨ˆçš„åŸºç¤

### **1. å¯¦é©—ç›®æ¨™**

- ç†è§£ç¶²è·¯ç¨‹å¼è¨­è¨ˆçš„åŸºæœ¬æ¨¡å‹ (Client-Server)ã€‚
- å­¸ç¿’ä½¿ç”¨ Go çš„ \`net\` å¥—ä»¶ä¾†å»ºç«‹ä¸€å€‹ TCP ä¼ºæœå™¨ã€‚
- æŒæ¡ä½¿ç”¨ Goroutine (\`go\` é—œéµå­—) å¯¦ç¾ä½µç™¼è™•ç†å®¢æˆ¶ç«¯é€£ç·šçš„æ–¹æ³•ã€‚
- å­¸æœƒä½¿ç”¨ \`go test\` æŒ‡ä»¤ä¾†å°ç¶²è·¯ç¨‹å¼é€²è¡Œè‡ªå‹•åŒ–æ¸¬è©¦ã€‚

### **2. æ ¸å¿ƒçŸ¥è­˜é»**

- **TCP/IP**:
    - **IP (\`0.0.0.0\` vs \`127.0.0.1\`)**:
    
    \`127.0.0.1\` (localhost) æŒ‡çš„æ˜¯æœ¬æ©Ÿï¼Œåªæœ‰æœ¬æ©Ÿä¸Šçš„ç¨‹å¼å¯ä»¥é€£ç·šã€‚
    
    \`0.0.0.0\` ä»£è¡¨ç›£è½æœ¬æ©Ÿä¸Šæ‰€æœ‰çš„ç¶²è·¯ä»‹é¢ï¼Œè®“å…¶ä»–é›»è…¦ä¹Ÿå¯ä»¥é€éå€åŸŸç¶²è·¯é€£ç·šé€²ä¾†ã€‚
    
    - **TCP**: ä¸€ç¨®**é€£ç·šå°å‘**ã€**å¯é çš„**å‚³è¼¸å”è­°ã€‚åœ¨å‚³è¼¸è³‡æ–™å‰å¿…é ˆå…ˆå»ºç«‹é€£ç·š (ä¸‰æ¬¡æ¡æ‰‹)ï¼Œèƒ½ä¿è­‰è³‡æ–™ä¾åºã€ç„¡éŒ¯èª¤åœ°é€é”ã€‚
- **Go ç¶²è·¯ç¨‹å¼è¨­è¨ˆé—œéµå‡½å¼**:
    - \`net.Listen(network, address)\`: å»ºç«‹ä¸€å€‹ä¼ºæœå™¨ç›£è½å™¨ã€‚
    - \`listener.Accept()\`: ç­‰å¾…ä¸¦æ¥å—ä¸€å€‹æ–°çš„å®¢æˆ¶ç«¯é€£ç·šï¼Œå›å‚³ \`net.Conn\` ç‰©ä»¶ã€‚
    - \`conn.Read(b []byte)\` / \`conn.Write(b []byte)\`: å¾é€£ç·šä¸­è®€å–/å¯«å…¥ä½å…ƒçµ„è³‡æ–™ã€‚
    - \`bufio.NewReader(conn).ReadString('\\n')\`: ä¸€å€‹æ–¹ä¾¿çš„è¼”åŠ©å‡½å¼ï¼Œå¯ä»¥è®€å–ç›´åˆ°ç‰¹å®šåˆ†éš”ç¬¦çš„å­—ä¸²ã€‚
    - \`defer\`: ç”¨æ–¼ç¢ºä¿è³‡æº (å¦‚ç¶²è·¯é€£ç·š \`net.Conn\` æˆ–ç›£è½å™¨ \`net.Listener\`) åœ¨å‡½å¼çµæŸæ™‚è¢«æ­£ç¢ºé—œé–‰ã€‚
- **Go ä½µç™¼ (Concurrency)**:
    - **Goroutine**: Go èªè¨€å¯¦ç¾ä½µç™¼çš„æ ¸å¿ƒã€‚ä½¿ç”¨ \`go\` é—œéµå­—å¯ä»¥éå¸¸è¼•æ˜“åœ°å•Ÿå‹•ä¸€å€‹ä½µç™¼åŸ·è¡Œçš„å‡½å¼ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œ\`go handler(conn)\` è®“æˆ‘å€‘çš„ä¸»è¿´åœˆä¸å¿…ç­‰å¾…å®¢æˆ¶ç«¯è™•ç†å®Œç•¢ï¼Œå¾è€Œå¯¦ç¾é«˜ä½µç™¼ã€‚

### **3. ç¨‹å¼ç¢¼æ¶æ§‹**

- **\`TCPListener\` (ç›£è½è€…)**:
    1. **ç¶å®š** IP å’Œ Port (\`net.Listen\`)ã€‚
    2. é€²å…¥**ç„¡é™è¿´åœˆ**ã€‚
    3. åœ¨è¿´åœˆä¸­**ç­‰å¾…**æ–°çš„é€£ç·š (\`server.Accept\`)ã€‚
    4. æ¯ç•¶æœ‰æ–°é€£ç·šé€²ä¾†ï¼Œå°±**å•Ÿå‹•ä¸€å€‹æ–°çš„ Goroutine** (\`go TCPHandler\`) å°‡é€£ç·šäº¤çµ¦å®ƒè™•ç†ã€‚
- **\`TCPHandler\` (è™•ç†è€…)**:
    1. æ¥æ”¶ä¸€å€‹ \`net.Conn\` ç‰©ä»¶ä½œç‚ºåƒæ•¸ã€‚
    2. é€²å…¥**ç„¡é™è¿´åœˆ**ä¾†æŒçºŒæœå‹™é€™å€‹å®¢æˆ¶ç«¯ã€‚
    3. åœ¨è¿´åœˆä¸­**è®€å–**å®¢æˆ¶ç«¯å‚³ä¾†çš„è³‡æ–™ (\`ReadString\`)ã€‚
    4. å°‡è®€åˆ°çš„è³‡æ–™**å¯«å›**çµ¦å®¢æˆ¶ç«¯ (\`Write\`)ã€‚
    5. å¦‚æœè®€å¯«å‡ºéŒ¯ (å¦‚å®¢æˆ¶ç«¯æ–·ç·š)ï¼Œå‰‡çµæŸè¿´åœˆä¸¦**é—œé–‰é€£ç·š**ã€‚

### **4. é©—è­‰æ–¹æ³•**

- ä½¿ç”¨ \`make test\` å‘½ä»¤ï¼Œå®ƒæœƒåŸ·è¡Œ \`go test\`ã€‚
- æ¸¬è©¦è…³æœ¬æœƒæ¨¡æ“¬å¤šå€‹å®¢æˆ¶ç«¯åŒæ™‚é€£ç·šåˆ°ä½ çš„ä¼ºæœå™¨ï¼Œä¸¦ç™¼é€è¨Šæ¯ï¼Œç„¶å¾Œæª¢æŸ¥ä¼ºæœå™¨çš„å›æ‡‰æ˜¯å¦æ­£ç¢ºã€‚
- çœ‹åˆ° \`PASS\` å’Œ \`ok\` å³ä»£è¡¨å¯¦é©—æˆåŠŸã€‚

### 5. å¯¦ç¾ \`TcpListener()\` å’Œ \`TcpHandler()\` é€™å…©å€‹å‡½å¼ï¼Œä¸¦æ»¿è¶³ä»¥ä¸‹è¡Œç‚ºï¼š

- **åŒæ™‚è™•ç†å¤šå€‹é€£ç·š**ï¼šä¼ºæœå™¨ä¸èƒ½å› ç‚ºæœå‹™ä¸€å€‹å®¢æˆ¶ç«¯å°±å¡ä½ï¼Œå¿…é ˆèƒ½åŒæ™‚æ¥å—æ–°çš„å®¢æˆ¶ç«¯é€£ç·šã€‚
- **å›æ‡‰æ”¶åˆ°çš„è¨Šæ¯**ï¼šä¼ºæœå™¨è¦æŠŠå¾å®¢æˆ¶ç«¯æ”¶åˆ°çš„ä»»ä½•è¨Šæ¯ï¼ŒåŸå°ä¸å‹•åœ°é€å›å»ã€‚é€™é€šå¸¸è¢«ç¨±ç‚º "Echo Server"ã€‚

è§£æ \`tcp.go\` ç¨‹å¼ç¢¼

\`TCPListener\` å‡½å¼:
è² è²¬**ç›£è½**æŒ‡å®šçš„ IP å’Œ portï¼Œä¸¦**æ¥å—**æ–°çš„å®¢æˆ¶ç«¯é€£ç·šã€‚

\`\`\`go
func TCPListener(host string, port int, handler handlerInterface) {
    // 1. å»ºç«‹ç›£è½å™¨ (Listener)
    // net.Listen("tcp", ...) æœƒåœ¨æŒ‡å®šçš„ host å’Œ port ä¸Šé–‹å§‹ç›£è½ TCP é€£ç·šã€‚
    // å¦‚æœæˆåŠŸï¼Œå®ƒæœƒå›å‚³ä¸€å€‹ listener ç‰©ä»¶ï¼›å¦‚æœå¤±æ•— (ä¾‹å¦‚ port å·²è¢«ä½”ç”¨)ï¼Œå‰‡å›å‚³ errorã€‚
    server, err := net.Listen("tcp", fmt.Sprintf("%s:%d", host, port))
    if err != nil {
        log.Fatalf("Server can't listening on port %d: %v", port, err)
    }
    // 2. ç¢ºä¿å‡½å¼çµæŸæ™‚é—œé–‰ç›£è½å™¨
    // defer server.Close() å®ƒä¿è­‰ä¸è«–å‡½å¼å¦‚ä½•çµæŸï¼Œ
    // server.Close() éƒ½æœƒè¢«åŸ·è¡Œï¼Œç¢ºä¿è³‡æºè¢«é‡‹æ”¾ã€‚
    defer server.Close()

    log.Printf("TCP is listening on %s:%d", host, port)

    // 3. ç„¡çª®è¿´åœˆï¼ŒæŒçºŒæ¥å—æ–°é€£ç·š
    for {
        // server.Accept() æœƒåœ¨é€™è£¡ã€Œå¡ä½ã€(block)ï¼Œç›´åˆ°æœ‰ä¸€å€‹æ–°çš„å®¢æˆ¶ç«¯é€£ç·šé€²ä¾†ã€‚
        // é€£ç·šæˆåŠŸå¾Œï¼Œå®ƒæœƒå›å‚³ä¸€å€‹ä»£è¡¨é€™å€‹é€£ç·šçš„ conn ç‰©ä»¶ã€‚
        conn, err := server.Accept()
        if err != nil {
            log.Fatalf("Accept failed: %v", err)
        }

        log.Printf("new client accepted: %s", conn.RemoteAddr().String())
        
        // 4. é—œéµï¼ä½µç™¼è™•ç†é€£ç·š
        // é€™è£¡å°±æ˜¯ã€Œæ”¯æ´åŒæ™‚è™•ç†å¤šå€‹é€£ç·šã€çš„é­”æ³•æ‰€åœ¨ï¼
        // \`go handler(conn)\` æœƒå•Ÿå‹•ä¸€å€‹æ–°çš„ goroutine (å¯ä»¥æƒ³æˆæ˜¯ä¸€å€‹è¼•é‡ç´šçš„åŸ·è¡Œç·’)ã€‚
        // é€™è®“ä¸»è¿´åœˆä¸ç”¨ç­‰å¾… \`handler\` è™•ç†å®Œç•¢ï¼Œå¯ä»¥ç«‹åˆ»å›å»ç¹¼çºŒåŸ·è¡Œ \`server.Accept()\`ï¼Œ
        // ç­‰å¾…ä¸‹ä¸€å€‹å®¢æˆ¶ç«¯é€£ç·šã€‚
        go handler(conn)
    }
}
\`\`\`

\`TCPHandler\` å‡½å¼:
é€™å€‹å‡½å¼è² è²¬è™•ç†**å–®ä¸€**çš„å®¢æˆ¶ç«¯é€£ç·šã€‚

\`\`\`go
func TCPHandler(conn net.Conn) {
    // 1. ç¢ºä¿å‡½å¼çµæŸæ™‚é—œé–‰é€£ç·š
    // èˆ‡ listener ä¸€æ¨£ï¼Œç¢ºä¿èˆ‡é€™å€‹å®¢æˆ¶ç«¯çš„é€£ç·šæœ€çµ‚æœƒè¢«é—œé–‰ã€‚
    defer conn.Close()
    clientAddr := conn.RemoteAddr().String()
    log.Printf("Handle Request from [%s]", clientAddr)

    // 2. ç„¡çª®è¿´åœˆï¼ŒæŒçºŒè™•ç†ä¾†è‡ªæ­¤å®¢æˆ¶ç«¯çš„è¨Šæ¯
    for {
        // 3. è®€å–è³‡æ–™
        // bufio.NewReader(conn).ReadString('\\n') æœƒå¾é€£ç·šä¸­è®€å–è³‡æ–™ï¼Œ
        // ç›´åˆ°è®€åˆ°æ›è¡Œç¬¦è™Ÿ \`\\n\` ç‚ºæ­¢ã€‚
        data, err := bufio.NewReader(conn).ReadString('\\n')
        if err != nil {
            // å¦‚æœè®€å–æ™‚ç™¼ç”ŸéŒ¯èª¤ (ä¾‹å¦‚å®¢æˆ¶ç«¯æ–·ç·šäº†ï¼Œæœƒæ”¶åˆ° EOF éŒ¯èª¤)ï¼Œ
            // å°±å°å‡º log ä¸¦çµæŸé€™å€‹ handlerã€‚
            log.Printf("Client [%s] Error: %v", clientAddr, err)
            return
        }
        
        // 4. å›å‚³è³‡æ–™ (Echo)
        // conn.Write([]byte(data)) å°‡å‰›å‰›æ”¶åˆ°çš„è³‡æ–™è½‰æ›æˆ byte é™£åˆ—ï¼Œ
        // ç„¶å¾Œå†å¯«å›çµ¦åŒä¸€å€‹å®¢æˆ¶ç«¯ï¼Œå®Œæˆã€ŒEchoã€çš„ä»»å‹™ã€‚
        _, err = conn.Write([]byte(data))
        if err != nil {
            log.Printf("Reply to Client [%s] failed: %v", clientAddr, err)
            return
        }
    }
}
\`\`\`

å·²ç¶“ç†è§£äº†ç¨‹å¼ç¢¼ï¼Œ\`README.md\` å’Œ \`Makefile\` å‘Šè¨´æˆ‘è©²å¦‚ä½•é©—è­‰å®ƒã€‚

- **é–‹å•Ÿä½ çš„çµ‚ç«¯æ©Ÿ (Terminal)**ã€‚
- **åˆ‡æ›åˆ° Lab 0 çš„å°ˆæ¡ˆç›®éŒ„ä¸‹**ã€‚
- **åŸ·è¡Œå‘½ä»¤**ï¼š

\`\`\`go
go test -v -race -timeout 30s ./...
\`\`\`

çµæœ:

\`\`\`go
PS D:\\Labs\\free5GLabs\\Lab0> go test -v -race -timeout 30s ./...
=== RUN   TestTcpFunction
2025/09/06 18:51:32 TCP is listening on 127.0.0.1:8080
2025/09/06 18:51:37 new client accepted: 127.0.0.1:52396
2025/09/06 18:51:37 Handle Request from [127.0.0.1:52396]
2025/09/06 18:51:37 new client accepted: 127.0.0.1:52397
2025/09/06 18:51:37 Handle Request from [127.0.0.1:52397]
2025/09/06 18:51:37 new client accepted: 127.0.0.1:52398
2025/09/06 18:51:37 Handle Request from [127.0.0.1:52398]
2025/09/06 18:51:37 new client accepted: 127.0.0.1:52399
2025/09/06 18:51:37 Handle Request from [127.0.0.1:52399]
2025/09/06 18:51:37 new client accepted: 127.0.0.1:52400
2025/09/06 18:51:37 Handle Request from [127.0.0.1:52400]
2025/09/06 18:51:37 new client accepted: 127.0.0.1:52401
2025/09/06 18:51:37 Handle Request from [127.0.0.1:52401]
2025/09/06 18:51:37 new client accepted: 127.0.0.1:52402
2025/09/06 18:51:37 Handle Request from [127.0.0.1:52402]
2025/09/06 18:51:37 new client accepted: 127.0.0.1:52403
2025/09/06 18:51:37 Handle Request from [127.0.0.1:52403]
2025/09/06 18:51:37 new client accepted: 127.0.0.1:52404
2025/09/06 18:51:37 Handle Request from [127.0.0.1:52404]
2025/09/06 18:51:37 new client accepted: 127.0.0.1:52405
2025/09/06 18:51:37 Handle Request from [127.0.0.1:52405]
--- PASS: TestTcpFunction (5.01s)
PASS
2025/09/06 18:51:37 Client [127.0.0.1:52402] Error: EOF
2025/09/06 18:51:37 Client [127.0.0.1:52400] Error: EOF
2025/09/06 18:51:37 Client [127.0.0.1:52401] Error: EOF
2025/09/06 18:51:37 Client [127.0.0.1:52399] Error: EOF
2025/09/06 18:51:37 Client [127.0.0.1:52398] Error: EOF
2025/09/06 18:51:37 Client [127.0.0.1:52397] Error: EOF
2025/09/06 18:51:37 Client [127.0.0.1:52396] Error: EOF
2025/09/06 18:51:37 Client [127.0.0.1:52404] Error: EOF
2025/09/06 18:51:37 Client [127.0.0.1:52405] Error: EOF
2025/09/06 18:51:37 Client [127.0.0.1:52403] Error: EOF
ok      github.com/ianchen0119/free5GLab/lab0   8.371s
?       github.com/ianchen0119/free5GLab/lab0/ans       [no test files]
\`\`\`

---

## è£œå……ï½œå¯¦å‹™æ³¨æ„äº‹é …ï¼ˆå¯ä¹‹å¾Œé€æ­¥æ“´å……ï¼‰
- **é»åŒ…/æ‹†åŒ…**ï¼šè‹¥æ”¹ç‚º \`Read\`/è‡ªè¨‚å”è­°ï¼Œå‹™å¿…è™•ç†è¨Šæ¡†é‚Šç•Œï¼ˆé•·åº¦å‰ç¶´ã€åˆ†éš”ç¬¦ã€æˆ–ä½¿ç”¨ \`bufio.Scanner\` è‡ªè¨‚ Splitï¼‰ã€‚  
- **é€¾æ™‚/å­˜æ´»**ï¼šç‚ºé¿å…é€£ç·šæ›ä½ï¼ŒåŠ ä¸Š \`conn.SetReadDeadline\` / \`SetWriteDeadline\` æˆ– idle timeoutã€‚  
- **å„ªé›…é—œé–‰**ï¼šç”¨ \`context\` + \`server.Close()\` çµ‚æ­¢ accept è¿´åœˆï¼Œä¸¦è¿½è¹¤ goroutines ç­‰å¾…æ”¶æ–‚ã€‚  
- **-race çš„æ„ç¾©**ï¼šè³‡æ–™ç«¶è³½åµæ¸¬å™¨å°ä½µç™¼ç¨‹å¼å¾ˆæœ‰å¹«åŠ©ï¼Œæ¸¬è©¦æ™‚ä¿æŒé–‹å•Ÿã€‚  
- **0.0.0.0 èˆ‡ 127.0.0.1**ï¼šæœ¬åœ°æ¸¬è©¦ç”¨ \`127.0.0.1\`ï¼›è‹¥è¦è¢«å…¶ä»–ä¸»æ©Ÿé€£åˆ°è«‹æ”¹ \`0.0.0.0\` ä¸¦æ³¨æ„é˜²ç«ç‰†/å®‰å…¨æ€§ã€‚  
- **å£“æ¸¬**ï¼šå¯ç”¨ \`hey\`ã€\`wrk\` æˆ–è‡ªå¯« goroutines å®¢æˆ¶ç«¯åšå¤šé€£ç·šå£“åŠ›æ¸¬è©¦ï¼Œè§€å¯Ÿ CPU/è¨˜æ†¶é«”èˆ‡ accept/handler è¡Œç‚ºã€‚
`
  },
    // *******************************************************************
      // *******************************************************************
        // *******************************************************************


  {
    id: "n-free5gc-lab1",
    slug: "free5gc-lab1-concurrent-programming-go",
    title: "free5GC Lab1ï¼šä½µç™¼ç¨‹å¼è¨­è¨ˆ (Concurrent Programming)",
    date: "2025-09-06",
    category: "school-curriculum",
    cover: `${process.env.PUBLIC_URL}/free5gc.png`,
    tags: [
      "free5GC","5G","Networking","Go","Goroutine","Channel","Mutex","Atomic",
      "Select","WaitGroup","Context","Concurrency","Lab1","NYCU"
    ],
    summary:
      "Go ä½µç™¼ç¨‹å¼è¨­è¨ˆå…¥é–€ï¼šGoroutineã€Channelï¼ˆå«ç„¡/æœ‰ç·©è¡ã€å–®å‘é€šé“ï¼‰ã€Selectã€Atomicã€Mutexã€è‡ªæ—‹é–ã€WaitGroupã€Context å–æ¶ˆ/è¶…æ™‚ã€‚å«å¯¦ä½œé™·é˜±ã€ä¿®æ­£èˆ‡è£œå……å¯¦å‹™å»ºè­°ã€‚",
    content: [
      "# Lab1 **ä½µç™¼ç¨‹å¼è¨­è¨ˆ (Concurrent Programming)**",
      "",
      "**GitHub Repo**ï¼š[free5GLab](https://github.com/free5gc/free5GLabs)",
      "",
      "## ä»€éº¼æ˜¯ä½µç™¼ (Concurrency)ï¼Ÿ",
      "",
      "ä½µç™¼æ˜¯æŒ‡**è™•ç†**å¤šå€‹ä»»å‹™çš„èƒ½åŠ›ï¼Œä½†ä¸ä¸€å®š**åŒæ™‚åŸ·è¡Œ**ã€‚æƒ³åƒä¸€å€‹å»šå¸«ï¼Œä»–ä¸€ä¸‹åˆ‡èœã€ä¸€ä¸‹çœ‹ç«ã€ä¸€ä¸‹èª¿å‘³ã€‚ä»–é›–ç„¶åªæœ‰ä¸€å€‹äººï¼Œå»èƒ½è®“å¤šé“èœçš„é€²åº¦åŒæ™‚æ¨é€²ï¼Œé€™å°±æ˜¯ä½µç™¼ã€‚Go èªè¨€é€é **Goroutine** å’Œ **Channel** è®“ä½µç™¼ç¨‹å¼è¨­è¨ˆè®Šå¾—éå¸¸ç°¡å–®ã€‚",
      "",
      "## Race Condition & Critical Section (ç«¶çˆ­æ¢ä»¶èˆ‡è‡¨ç•Œå€)",
      "",
      "å…©å€‹æˆ–å¤šå€‹ Goroutine åŒæ™‚å­˜å–ä¸€å€‹å…±äº«è³‡æºï¼ˆä¾‹å¦‚ä¸€å€‹è®Šæ•¸ï¼‰ï¼Œä¸”è‡³å°‘æœ‰ä¸€å€‹æœƒä¿®æ”¹å®ƒæ™‚ï¼Œå°±æœƒç™¼ç”Ÿ **Race Condition**ã€‚é€™æœƒå°è‡´çµæœä¸å¯é æ¸¬ï¼Œå°±åƒå…©å€‹ äººåŒæ™‚æ¶è‘—ä¿®æ”¹åŒä¸€ä»½æ–‡ä»¶ï¼Œæœ€å¾Œçš„å…§å®¹å¯èƒ½æœƒäº‚ä¸ƒå…«ç³Ÿã€‚",
      "",
      "- **Critical Section (è‡¨ç•Œå€)**ï¼šå°±æ˜¯é‚£æ®µå­˜å–å…±äº«è³‡æºçš„ç¨‹å¼ç¢¼ã€‚åœ¨ç¯„ä¾‹ä¸­ï¼Œ`counter++` å°±æ˜¯è‡¨ç•Œå€ã€‚",
      "- **å¦‚ä½•è§£æ±º**ï¼šæˆ‘å€‘éœ€è¦ä¸€ç¨®æ©Ÿåˆ¶ä¾†ç¢ºä¿ä¸€æ¬¡åªæœ‰ä¸€å€‹ Goroutine èƒ½é€²å…¥è‡¨ç•Œå€ï¼Œé€™å°±æ˜¯**åŒæ­¥ (Synchronization)**ï¼Œä¸‹é¢ä»‹ç´¹çš„ `Atomic`ã€`Mutex` ç­‰éƒ½æ˜¯å¯¦ç¾åŒæ­¥çš„æ–¹æ³•ã€‚",
      "",
      "### Goroutineï¼šè¼•é‡ç´šåŸ·è¡Œç·’",
      "",
      "Goroutine æ˜¯ Go èªè¨€å¯¦ç¾ä½µç™¼çš„æ ¸å¿ƒã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³åƒæˆä¸€å€‹éå¸¸è¼•é‡ã€å•Ÿå‹•æˆæœ¬æ¥µä½çš„ã€Œå°ä»»å‹™ã€ã€‚åœ¨å‡½å¼å‘¼å«å‰åŠ ä¸Š `go` é—œéµå­—ï¼Œå°±èƒ½ç‚ºé€™å€‹å‡½å¼å»ºç«‹ä¸€å€‹æ–°çš„ Goroutineã€‚",
      "",
      "```go",
      "// ç¨‹å¼æœƒç«‹åˆ»å¾€ä¸‹åŸ·è¡Œï¼Œä¸æœƒç­‰å¾… Goroutine çµæŸ",
      "go func() {",
      '    fmt.Println("Hello from another Goroutine!")',
      "}()",
      "",
      "// ä¸»ç¨‹å¼éœ€è¦ç­‰å¾…ä¸€ä¸‹ï¼Œå¦å‰‡å¯èƒ½åœ¨ Goroutine åŸ·è¡Œå‰å°±çµæŸäº†",
      "time.Sleep(1 * time.Second)",
      "```",
      "",
      "### Atomic Operations (åŸå­æ“ä½œ)",
      "",
      "**åŸå­æ“ä½œ**æ˜¯æŒ‡ä¸€å€‹ã€Œä¸å¯åˆ†å‰²ã€çš„æ“ä½œã€‚åœ¨ä½µç™¼ç’°å¢ƒä¸‹ï¼Œå®ƒå¯ä»¥ä¿è­‰åœ¨åŸ·è¡Œéç¨‹ä¸­ä¸æœƒè¢«å…¶ä»– Goroutine ä¸­æ–·ã€‚é€™å°±åƒä¸€å€‹å–®ä¸€çš„ CPU æŒ‡ä»¤ï¼ŒåŸ·è¡Œå°±æ˜¯ä¸€ç¬é–“å®Œæˆã€‚",
      "",
      "å°æ–¼ç°¡å–®çš„è¨ˆæ•¸å™¨æ“ä½œï¼Œä½¿ç”¨ `sync/atomic` å¥—ä»¶æœƒæ¯”ä½¿ç”¨ `Mutex` æ›´æœ‰æ•ˆç‡ã€‚",
      "",
      "```go",
      'import "sync/atomic"',
      "",
      "var counter int32",
      "// å®‰å…¨åœ°å°‡ counter åŠ  1",
      "atomic.AddInt32(&counter, 1)",
      "```",
      "",
      "### åŒæ­¥å·¥å…·ï¼šSpinLock vs. Mutex",
      "",
      "é€™å…©è€…éƒ½æ˜¯ç”¨ä¾†ä¿è­·**è‡¨ç•Œå€**çš„é–ã€‚",
      "",
      "- **SpinLock (è‡ªæ—‹é–)**ï¼š",
      "    - **åŸç†**ï¼šç•¶ä¸€å€‹ Goroutine æƒ³è¦å–å¾—é–ï¼Œä½†é–å·²è¢«ä½”ç”¨æ™‚ï¼Œå®ƒæœƒé€²å…¥ä¸€å€‹ã€Œå¿™ç¢Œç­‰å¾…ã€çš„è¿´åœˆ (spin)ï¼Œä¸æ–·æª¢æŸ¥é–æ˜¯å¦è¢«é‡‹æ”¾ã€‚",
      "    - **å„ªé»**ï¼šåæ‡‰å¿«ï¼Œä¸€æ—¦é–è¢«é‡‹æ”¾èƒ½ç«‹åˆ»å–å¾—ã€‚",
      "    - **ç¼ºé»**ï¼šåœ¨ç­‰å¾…æ™‚æœƒæŒçºŒæ¶ˆè€— CPU è³‡æºã€‚",
      "    - **é©ç”¨å ´æ™¯**ï¼šé–è¢«ä½”ç”¨çš„æ™‚é–“éå¸¸çŸ­çš„å ´åˆã€‚",
      "- **Mutex (äº’æ–¥é–)**ï¼š",
      "    - **åŸç†**ï¼šç•¶ä¸€å€‹ Goroutine æƒ³è¦å–å¾—é–ï¼Œä½†é–å·²è¢«ä½”ç”¨æ™‚ï¼ŒGo çš„æ’ç¨‹å™¨æœƒè®“é€™å€‹ Goroutine **é€²å…¥ä¼‘çœ **ï¼ŒæŠŠ CPU è³‡æºè®“çµ¦å…¶ä»–ä»»å‹™ã€‚ç•¶é–è¢«é‡‹æ”¾æ™‚ï¼Œæ’ç¨‹å™¨æœƒå†å–šé†’å®ƒã€‚",
      "    - **å„ªé»**ï¼šç­‰å¾…æ™‚ä¸æ¶ˆè€— CPUã€‚",
      "    - **ç¼ºé»**ï¼šä¼‘çœ å’Œå–šé†’æœ‰ä¸€å®šçš„ç³»çµ±é–‹éŠ·ã€‚",
      "    - **é©ç”¨å ´æ™¯**ï¼šå¤§å¤šæ•¸æƒ…æ³ä¸‹çš„é¦–é¸ï¼ŒGo å…§å»ºçš„ `sync.Mutex` éå¸¸é«˜æ•ˆã€‚",
      "",
      "```go",
      'import "sync"',
      "",
      "var counter int",
      "var mu sync.Mutex",
      "",
      "// ä¿è­·è‡¨ç•Œå€",
      "mu.Lock()",
      "counter++",
      "mu.Unlock()",
      "```",
      "",
      "### Channelï¼šGoroutine ä¹‹é–“çš„æºé€šç®¡é“",
      "",
      "Go æå€¡ã€Œ**ä¸è¦é€éå…±äº«è¨˜æ†¶é«”ä¾†æºé€šï¼Œè€Œè¦é€éæºé€šä¾†å…±äº«è¨˜æ†¶é«”**ã€ã€‚Channel å°±æ˜¯å¯¦ç¾é€™å€‹ç†å¿µçš„å·¥å…·ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³åƒæˆä¸€å€‹å®‰å…¨çš„ã€Œå‚³é€å¸¶ã€ã€‚",
      "",
      "- **Unbuffered Channel (ç„¡ç·©è¡é€šé“)**ï¼š",
      "    - `ch := make(chan int)`",
      "    - å®¹é‡ç‚º 0ã€‚å‚³é€æ–¹ (`ch <- data`) æœƒè¢«**é˜»å¡**ï¼Œç›´åˆ°æ¥æ”¶æ–¹ (`<-ch`) æº–å‚™å¥½æ¥æ”¶ã€‚åä¹‹äº¦ç„¶ã€‚é€™æ˜¯ä¸€ç¨®å¼·åŠ›çš„**åŒæ­¥**æ©Ÿåˆ¶ã€‚",
      "- **Buffered Channel (æœ‰ç·©è¡é€šé“)**ï¼š",
      "    - `ch := make(chan int, 10)`",
      "    - å®¹é‡å¤§æ–¼ 0ã€‚åªè¦ç·©è¡å€æ²’æ»¿ï¼Œå‚³é€æ–¹å°±å¯ä»¥ç«‹åˆ»å‚³é€è³‡æ–™è€Œä¸æœƒè¢«é˜»å¡ã€‚åªè¦ç·©è¡å€ä¸ç‚ºç©ºï¼Œæ¥æ”¶æ–¹å°±å¯ä»¥ç«‹åˆ»æ¥æ”¶è³‡æ–™ã€‚",
      "- **Unidirectional Channel (å–®å‘é€šé“)**ï¼š",
      "    - `chan<- int`: åªèƒ½å‚³é€ (send-only)ã€‚",
      "    - `<-chan int`: åªèƒ½æ¥æ”¶ (receive-only)ã€‚",
      "    - é€™èƒ½è®“å‡½å¼çš„ä»‹é¢æ›´å®‰å…¨ï¼Œé˜²æ­¢èª¤ç”¨ã€‚",
      "",
      "### Selectï¼šå¤šè·¯é€šé“ç›£è½å™¨",
      "",
      "`select` é™³è¿°å¼å¯ä»¥è®“ä½ åŒæ™‚ç­‰å¾…å¤šå€‹ Channel æ“ä½œã€‚å®ƒæœƒ**é˜»å¡**ï¼Œç›´åˆ°å…¶ä¸­ä¸€å€‹ `case` çš„ Channel æ“ä½œå¯ä»¥é€²è¡Œï¼ˆå¯ä»¥å‚³é€æˆ–æ¥æ”¶ï¼‰ï¼Œç„¶å¾ŒåŸ·è¡Œè©² `case`ã€‚å¦‚æœæœ‰å¤šå€‹ `case` åŒæ™‚å°±ç·’ï¼Œå®ƒæœƒ**éš¨æ©Ÿé¸æ“‡ä¸€å€‹**åŸ·è¡Œã€‚",
      "",
      "```go",
      "select {",
      "case msg1 := <-ch1:",
      '    fmt.Println("received", msg1)',
      "case ch2 <- msg2:",
      '    fmt.Println("sent", msg2)',
      "case <-time.After(1 * time.Second): // è¶…æ™‚æ©Ÿåˆ¶",
      '    fmt.Println("timeout")',
      "default: // å¦‚æœæ²’æœ‰ä»»ä½• case å°±ç·’ï¼ŒæœƒåŸ·è¡Œ default",
      '    fmt.Println("no communication")',
      "}",
      "```",
      "",
      "### WaitGroupï¼šç­‰å¾…ä¸€ç¾¤ Goroutine å®Œæˆ",
      "",
      "`sync.WaitGroup` ç”¨æ–¼ç­‰å¾…ä¸€çµ„ Goroutine å…¨éƒ¨åŸ·è¡Œå®Œç•¢ã€‚å®ƒå…§éƒ¨ç¶­è­·ä¸€å€‹è¨ˆæ•¸å™¨ã€‚",
      "",
      "- `wg.Add(n)`ï¼šè¨ˆæ•¸å™¨åŠ  nã€‚é€šå¸¸åœ¨å•Ÿå‹• Goroutine å‰å‘¼å«ã€‚",
      "- `wg.Done()`ï¼šè¨ˆæ•¸å™¨æ¸› 1ã€‚é€šå¸¸åœ¨ Goroutine çµæŸæ™‚ä½¿ç”¨ `defer` å‘¼å«ã€‚",
      "- `wg.Wait()`ï¼šé˜»å¡ä¸»ç¨‹å¼ï¼Œç›´åˆ°è¨ˆæ•¸å™¨æ­¸é›¶ã€‚",
      "",
      "```go",
      "var wg sync.WaitGroup",
      "for i := 0; i < 5; i++ {",
      "    wg.Add(1) // è¨ˆæ•¸å™¨åŠ  1",
      "    go func(num int) {",
      "        defer wg.Done() // å‡½å¼çµæŸæ™‚è¨ˆæ•¸å™¨æ¸› 1",
      '        fmt.Printf("Worker %d done\\n", num)',
      "    }(i)",
      "}",
      "wg.Wait() // ç­‰å¾…æ‰€æœ‰ worker å®Œæˆ",
      'fmt.Println("All workers done")',
      "```",
      "",
      "### Contextï¼šæ§åˆ¶ Goroutine çš„ç”Ÿå‘½é€±æœŸ",
      "",
      "`context` å¥—ä»¶æä¾›äº†ä¸€ç¨®è·¨è¶Šå¤šå€‹ Goroutine å‚³é**æˆªæ­¢æ™‚é–“ (deadline)**ã€**å–æ¶ˆä¿¡è™Ÿ (cancellation signal)** å’Œå…¶ä»–è«‹æ±‚ç¯„åœå€¼çš„æ–¹æ³•ã€‚",
      "",
      "å¦‚ä¸Šåœ–æ‰€ç¤ºï¼Œç•¶ä¸€å€‹è«‹æ±‚é€²ä¾†æ™‚ï¼Œä½ å¯èƒ½æœƒå•Ÿå‹•å¤šå€‹ `Worker`ï¼Œè€Œæ¯å€‹ `Worker` åˆå¯èƒ½å•Ÿå‹•å¤šå€‹ `Job`ã€‚å¦‚æœé€™å€‹è«‹æ±‚è¢«ä½¿ç”¨è€…å–æ¶ˆäº†ï¼Œæˆ‘å€‘å¸Œæœ›èƒ½æœ‰ä¸€ç¨®æ–¹æ³•å¯ä»¥**é€šçŸ¥æ‰€æœ‰**ç›¸é—œçš„ Goroutine åœæ­¢å·¥ä½œï¼Œä»¥é‡‹æ”¾è³‡æºã€‚é€™å°±æ˜¯ `Context` çš„ä¸»è¦ç”¨é€”ã€‚",
      "",
      "- `context.Background()`ï¼šé€šå¸¸æ˜¯æ‰€æœ‰ Context tree çš„æ ¹ã€‚",
      "- `context.WithCancel(parent)`ï¼šå‰µå»ºä¸€å€‹å¯ä»¥è¢«æ‰‹å‹•å–æ¶ˆçš„ Contextã€‚",
      "- åœ¨ Goroutine ä¸­ï¼Œä½¿ç”¨ `select` ç›£è½ `ctx.Done()` channelã€‚ä¸€æ—¦ Context è¢«å–æ¶ˆï¼Œé€™å€‹ channel å°±æœƒè¢«é—œé–‰ï¼ŒGoroutine å°±å¯ä»¥åŸ·è¡Œæ¸…ç†å·¥ä½œä¸¦é€€å‡ºã€‚",
      "",
      "```go",
      "func worker(ctx context.Context, name string) {",
      "    for {",
      "        select {",
      "        case <-ctx.Done(): // Context è¢«å–æ¶ˆäº†",
      '            fmt.Println(name, "is stopping...")',
      "            return }",
      "        default:",
      '            fmt.Println(name, "is working...")',
      "            time.Sleep(1 * time.Second)",
      "        }",
      "    }",
      "}",
      "",
      "func main() {",
      "    // å‰µå»ºä¸€å€‹å¯ä»¥å–æ¶ˆçš„ context",
      "    ctx, cancel := context.WithCancel(context.Background())",
      "",
      '    go worker(ctx, "Worker1")',
      '    go worker(ctx, "Worker2")',
      "",
      "    time.Sleep(3 * time.Second)",
      '    fmt.Println("Main: issuing cancellation")',
      "    cancel() // ç™¼å‡ºå–æ¶ˆä¿¡è™Ÿ",
      "    time.Sleep(1 * time.Second) // ç­‰å¾… worker é€€å‡º",
      "}",
      "```",
      "",
      "## ç·´ç¿’é¡Œè§£æ",
      "",
      "é€™è£¡å°‡ `Answer.md` çš„å…§å®¹èˆ‡å•é¡Œçµåˆï¼Œä¸¦æä¾›æ›´è©³ç´°çš„èªªæ˜ã€‚",
      "",
      "- **ä»€éº¼æ˜¯åŸå­æ“ä½œ (atomic operation)ï¼Ÿ**",
      "    - **ç­”æ¡ˆ**ï¼šåŸå­æ“ä½œæ˜¯ä¸€å€‹ç›¸å°æ–¼å…¶ä»–åŸ·è¡Œç·’æˆ–é€²ç¨‹ä¾†èªªï¼Œåœ¨å–®ä¸€æ­¥é©Ÿå…§å®Œæˆçš„ä½éšæ“ä½œã€‚å®ƒé€šå¸¸ç”±ç¡¬é«”çš„ CPU æŒ‡ä»¤ç›´æ¥æ”¯æ´ï¼Œä¿è­‰æ“ä½œçš„å®Œæ•´æ€§ï¼Œä¸æœƒè¢«ä¸­æ–·ã€‚",
      "- **ä¸‹é¢çš„ç¯„ä¾‹æœ‰ä½µç™¼å•é¡Œå—ï¼Ÿç‚ºä»€éº¼ï¼Ÿ**",
      "",
      "```go",
      "var a int64",
      "func main() {",
      "    var wg sync.WaitGroup",
      "    wg.Add(1)",
      "",
      "    go func() {",
      "        increment()",
      "        wg.Done()",
      "    }()",
      "    wg.Wait()",
      '    fmt.Println("Final value of a:", a)',
      "}",
      "func increment() {",
      "    for i := 0; i < 100000000; i++ {",
      "        go func() {",
      "             a = a + 1",
      "        }()",
      "    }",
      "}",
      "```",
      "",
      "- **ç­”æ¡ˆ**ï¼š**æœ‰åš´é‡çš„ä½µç™¼å•é¡Œ**ã€‚",
      "- **åŸå› **ï¼š`a = a + 1` é€™å€‹æ“ä½œä¸æ˜¯åŸå­çš„ã€‚å®ƒå¯¦éš›ä¸ŠåŒ…å«ä¸‰å€‹æ­¥é©Ÿï¼š1. è®€å– `a` çš„å€¼åˆ°æš«å­˜å™¨ã€‚2. å°‡æš«å­˜å™¨çš„å€¼åŠ  1ã€‚3. å°‡æ–°å€¼å¯«å› `a`ã€‚ç•¶å¤§é‡ Goroutine åŒæ™‚åŸ·è¡Œé€™ä¸‰æ­¥æ™‚ï¼Œæœƒäº’ç›¸è¦†è“‹çµæœï¼Œå°è‡´æœ€çµ‚çš„ `a` é å°æ–¼é æœŸå€¼ã€‚é€™å°±æ˜¯å…¸å‹çš„ **Race Condition**ã€‚",
      "- **ä¿®æ­£**ï¼šæ‡‰ä½¿ç”¨ `atomic.AddInt64(&a, 1)` ä¾†ä¿è­‰è¨ˆæ•¸æ“ä½œçš„åŸå­æ€§ã€‚",
      "- **`wg.Add(1)` å’Œ `wg.Done()` æ˜¯åšä»€éº¼çš„ï¼Ÿ`1` ä»£è¡¨ä»€éº¼ï¼Ÿ**",
      "    - **ç­”æ¡ˆ**ï¼š",
      "        - `wg.Add(1)`ï¼šå‘Šè¨´ `WaitGroup` çš„è¨ˆæ•¸å™¨ã€Œæœ‰ä¸€å€‹æ–°çš„ä»»å‹™éœ€è¦ç­‰å¾…ã€ï¼Œè¨ˆæ•¸å™¨åŠ  1ã€‚",
      "        - `wg.Done()`ï¼šå‘Šè¨´ `WaitGroup` çš„è¨ˆæ•¸å™¨ã€Œæœ‰ä¸€å€‹ä»»å‹™å®Œæˆäº†ã€ï¼Œè¨ˆæ•¸å™¨æ¸› 1ã€‚",
      "        - `1` ä»£è¡¨è¦å¢åŠ åˆ°ç­‰å¾…è¨ˆæ•¸å™¨ä¸­çš„ Goroutine æ•¸é‡ã€‚",
      "- **è«‹å®šç¾©ä¸€å€‹åŒ…å«æ•´æ•¸æ¬„ä½å’Œ `sync.Mutex` çš„ `Counter` çµæ§‹ï¼Œä¸¦å¯¦ä½œä¸€å€‹å®‰å…¨éå¢è¨ˆæ•¸å™¨çš„å‡½å¼ã€‚**",
      "    - **ç­”æ¡ˆ**ï¼š",
      "",
      "```go",
      'import "sync"',
      "",
      "// Counter çµæ§‹åŒ…å«ä¸€å€‹äº’æ–¥é–å’Œä¸€å€‹å€¼",
      "type Counter struct {",
      "    mu    sync.Mutex",
      "    value int",
      "}",
      "",
      "// Increment å‡½å¼å®‰å…¨åœ°å°‡è¨ˆæ•¸å™¨åŠ ä¸€",
      "func (c *Counter) Increment() {",
      "    c.mu.Lock()   // åœ¨ä¿®æ”¹ value å‰é–å®š",
      "    defer c.mu.Unlock() // ç¢ºä¿å‡½å¼çµæŸæ™‚è§£é–",
      "    c.value++",
      "}",
      "```",
      "",
      "- ç‚ºä»€éº¼ä¸‹é¢çš„ç¨‹å¼ç¢¼æœƒå‡ºç¾è‡´å‘½éŒ¯èª¤ï¼Ÿ",
      "",
      "```go",
      "func main() {",
      "    var intChan chan int",
      "    fmt.Println(intChan)",
      "    intChan <- 10",
      "}",
      "```",
      "",
      "- **ç­”æ¡ˆ**ï¼šå› ç‚º `var intChan chan int` åªæ˜¯å®£å‘Šäº†ä¸€å€‹ Channel è®Šæ•¸ï¼Œå®ƒçš„åˆå§‹å€¼æ˜¯ `nil`ã€‚ä½ å¿…é ˆä½¿ç”¨ `make` ä¾†åˆå§‹åŒ–ä¸¦åˆ†é…è¨˜æ†¶é«”ç©ºé–“ï¼Œä¾‹å¦‚ `intChan := make(chan int)`ã€‚å°ä¸€å€‹ `nil` channel é€²è¡Œå‚³é€æˆ–æ¥æ”¶æ“ä½œæœƒå°è‡´æ‰€æœ‰ Goroutine æ°¸ä¹…é˜»å¡ï¼Œå¼•ç™¼ `deadlock` éŒ¯èª¤ã€‚",
      "- åœ¨ `Select` çš„è¶…æ™‚æ©Ÿåˆ¶ç¯„ä¾‹ä¸­ï¼Œä½¿ç”¨ `time.After` å¯èƒ½æœ‰æ½›åœ¨çš„è¨˜æ†¶é«”æ´©æ¼å•é¡Œã€‚è«‹æè¿°åŸå› ä¸¦ä¿®æ­£ã€‚",
      "    - **åŸå› **ï¼š`time.After(d)` å‡½å¼æœƒç«‹å³å›å‚³ä¸€å€‹ channelï¼Œä¸¦åœ¨åº•å±¤å•Ÿå‹•ä¸€å€‹æ–°çš„ Goroutineï¼Œé€™å€‹ Goroutine æœƒåœ¨ç­‰å¾…æ™‚é–“ `d` éå¾Œå‘è©² channel ç™¼é€ç•¶å‰æ™‚é–“ã€‚å¦‚æœåœ¨ `select` é™³è¿°å¼ä¸­ï¼Œæ˜¯å…¶ä»– `case` å…ˆè¢«è§¸ç™¼è€Œé€€å‡ºäº† `select`ï¼Œé‚£éº¼ `time.After` å‰µå»ºçš„é‚£å€‹åº•å±¤ Goroutine å’Œ channel å°±æ°¸é æ²’æœ‰æ©Ÿæœƒè¢«è®€å–ï¼Œå®ƒå€‘çš„è³‡æºç›´åˆ°è¨ˆæ™‚å™¨åˆ°æœŸå‰éƒ½ç„¡æ³•è¢«åƒåœ¾å›æ”¶ (GC)ã€‚å¦‚æœåœ¨ä¸€å€‹è¿´åœˆä¸­é »ç¹ä½¿ç”¨é€™ç¨®æ¨¡å¼ï¼Œå°±æœƒç´¯ç©å¤§é‡çš„æ´©æ¼è³‡æºã€‚",
      "    - **ä¿®æ­£**ï¼šæ›´å¥½çš„ä½œæ³•æ˜¯ä½¿ç”¨ `time.NewTimer`ã€‚`Timer` ç‰©ä»¶å¯ä»¥è¢«æ˜ç¢ºåœ°åœæ­¢ (`timer.Stop()`)ï¼Œå¾è€Œæå‰é‡‹æ”¾ç›¸é—œè³‡æºã€‚",
      "",
      "```go",
      "// ä¿®æ­£å¾Œçš„ç¨‹å¼ç¢¼",
      "func main() {",
      "    timeout := make(chan bool, 1)",
      "    go func() {",
      "        time.Sleep(1 * time.Second)",
      "        timeout <- true",
      "    }()",
      "    ch := make(chan int)",
      "",
      "    timer := time.NewTimer(time.Second * 2)",
      "    // ç¢ºä¿ timer çš„è³‡æºåœ¨å‡½å¼çµæŸæ™‚è¢«é‡‹æ”¾",
      "    defer timer.Stop()",
      "",
      "    select {",
      "    case <-ch:",
      "    case <-timeout:",
      '        fmt.Println("Open5GS")',
      "    case <-timer.C: // ä½¿ç”¨ timer.C ä½œç‚º channel",
      '        fmt.Println("free5GC")',
      "    }",
      "}",
      "```",
      "",
      "---",
      "",
      "## è£œå……èˆ‡å¯¦å‹™å»ºè­°",
      "",
      "1. **è³‡æ–™ç«¶çˆ­åµæ¸¬**ï¼š",
      "   - ä½¿ç”¨ `go test -race` æˆ– `go run -race` åµæ¸¬ data raceï¼Œèƒ½ææ—©æŠ“åˆ°è®€å¯«è¡çªã€‚",
      "",
      "2. **Go è¨˜æ†¶é«”æ¨¡å‹ / happens-before**ï¼š",
      "   - åƒ…æœ‰ã€ŒåŒæ­¥äº‹ä»¶ã€ï¼ˆå¦‚ channel å‚³éã€`sync.Mutex` åŠ è§£é–ã€`sync/atomic`ï¼‰æ‰èƒ½å»ºç«‹æ˜ç¢ºçš„ happens-before é—œä¿‚ï¼Œç¢ºä¿å¯è¦‹æ€§ã€‚",
      "",
      "3. **é—œé–‰ channel çš„æ…£ä¾‹**ï¼š",
      "   - **åªæœ‰ sender è² è²¬é—œé–‰**ï¼›receiver ä¸æ‡‰é—œé–‰å®ƒã€Œè®€ã€çš„ channelã€‚",
      "   - é€é `for v := range ch { ... }` è¿´åœˆå®‰å…¨è®€å–ç›´åˆ°é—œé–‰ï¼š",
      "",
      "```go",
      "func producer(ch chan<- int) {",
      "    for i := 0; i < 10; i++ { ch <- i }",
      "    close(ch)",
      "}",
      "func consumer(ch <-chan int) {",
      "    for v := range ch { fmt.Println(v) }",
      "}",
      "```",
      "",
      "4. **worker pool ç¯„å¼**ï¼š",
      "   - ä½¿ç”¨ `jobs` / `results` å…©å€‹ channelï¼ŒåŠ ä¸Š `WaitGroup` æ§åˆ¶æ”¶å°¾ï¼Œèƒ½é¿å… goroutine æ³„æ¼ã€‚",
      "",
      "5. **select çš„å…¬å¹³æ€§**ï¼š",
      "   - å¤šå€‹åˆ†æ”¯åŒæ™‚å°±ç·’æ™‚æ˜¯**éš¨æ©Ÿ**æŒ‘é¸ï¼›è‹¥éœ€è¦å„ªå…ˆé †åºï¼Œè«‹èª¿æ•´çµæ§‹æˆ–è¨­è¨ˆå¤šå±¤ selectã€‚",
      "",
      "6. **Context çš„å‚³éåŸå‰‡**ï¼š",
      "   - ç”±**ä¸Šæ¸¸å»ºç«‹**ï¼Œä¸€è·¯å¾€ä¸‹å‚³éï¼›ä¸è¦æŠŠ `context.Context` å­˜æˆ struct æ¬„ä½é•·æœŸä¿å­˜ã€‚",
      "",
      "7. **è‡ªæ—‹é–æ…ç”¨**ï¼š",
      "   - åœ¨ Go å¸¸è¦‹å¯«æ³•è£¡ï¼Œ`sync.Mutex` å¹¾ä¹éƒ½æ¯”è‡ªæ—‹é–æ›´åˆé©ï¼›è‡ªæ—‹é–é©ç”¨æ–¼æ¥µçŸ­è‡¨ç•Œå€ä¸”ç«¶çˆ­éå¸¸ä½çš„æƒ…å¢ƒã€‚",
      "",
      "## ç¨‹å¼ç·´ç¿’",
      "```go",
      "package main",
      "",
      "import (",
      '    "context"',
      '    "fmt"',
      '    "sync"',
      '    "sync/atomic"',
      '    "time"',
      ")",
      "",
      "// Helper function to print section titles",
      "func printTitle(title string) {",
      '    fmt.Printf("\\n==================================================\\n")',
      '    fmt.Printf("====== %s\\n", title)',
      '    fmt.Printf("==================================================\\n")',
      "}",
      "",
      "func main() {",
      "    // åŸ·è¡Œ Lab 1 çš„æ‰€æœ‰ç¯„ä¾‹å’Œç·´ç¿’",
      "",
      "    // 1. Race Condition ç«¶çˆ­æ¢ä»¶å•é¡Œå±•ç¤º",
      "    demoRaceCondition()",
      "",
      "    // 2. ä½¿ç”¨ Atomic (åŸå­æ“ä½œ) è§£æ±ºç«¶çˆ­æ¢ä»¶",
      "    demoAtomic()",
      "",
      "    // 3. ä½¿ç”¨ Mutex (äº’æ–¥é–) è§£æ±ºç«¶çˆ­æ¢ä»¶ (ç·´ç¿’é¡Œ 4)",
      "    demoMutex()",
      "",
      "    // 4. Channel çš„å„ç¨®ç”¨æ³•",
      "    demoChannels()",
      "",
      "    // 5. Select çš„å¤šè·¯è¤‡ç”¨èˆ‡è¶…æ™‚",
      "    demoSelect()",
      "",
      "    // 6. WaitGroup ç­‰å¾… Goroutine å®Œæˆ",
      "    demoWaitGroup()",
      "",
      "    // 7. Context æ§åˆ¶ Goroutine çš„ç”Ÿå‘½é€±æœŸ",
      "    demoContext()",
      "",
      "    // 8. ç·´ç¿’é¡Œ 5: nil channel é€ æˆçš„ Deadlock",
      "    demoNilChannelError()",
      "",
      "    // 9. ç·´ç¿’é¡Œ 6: time.After çš„æ½›åœ¨å…§å­˜æ´©æ¼èˆ‡ä¿®æ­£",
      "    demoTimeAfterLeak()",
      "}",
      "",
      "// ==================================================",
      "// 1. Race Condition ç«¶çˆ­æ¢ä»¶å•é¡Œå±•ç¤º",
      "// ==================================================",
      "func demoRaceCondition() {",
      '    printTitle("1. Race Condition å±•ç¤º")',
      "    var counter int64 = 0",
      "    var wg sync.WaitGroup",
      "    numGoroutines := 5000",
      "",
      "    wg.Add(numGoroutines)",
      "    for i := 0; i < numGoroutines; i++ {",
      "        go func() {",
      "            defer wg.Done()",
      "            // é€™ä¸æ˜¯åŸå­æ“ä½œï¼Œæœƒå°è‡´ race condition",
      "            counter++",
      "        }()",
      "    }",
      "    wg.Wait()",
      "",
      '    fmt.Printf("é æœŸè¨ˆæ•¸ç‚º: %d\\n", numGoroutines)',
      '    fmt.Printf("ä¸ä½¿ç”¨é–çš„å¯¦éš›çµæœ: %d (é€šå¸¸æœƒå°æ–¼é æœŸå€¼)\\n", counter)',
      '    fmt.Println("åˆ†æ: å› ç‚º counter++ ä¸æ˜¯åŸå­æ“ä½œï¼Œå¤šå€‹ goroutine åŒæ™‚è®€å–ã€ä¿®æ”¹ã€å¯«å› counter æœƒå°è‡´æ›´æ–°éºå¤±ã€‚")',
      "}",
      "",
      "// ==================================================",
      "// 2. ä½¿ç”¨ Atomic (åŸå­æ“ä½œ) è§£æ±ºç«¶çˆ­æ¢ä»¶",
      "// ==================================================",
      "func demoAtomic() {",
      '    printTitle("2. Atomic åŸå­æ“ä½œè§£æ±ºæ–¹æ¡ˆ")',
      "    var counter int64 = 0",
      "    var wg sync.WaitGroup",
      "    numGoroutines := 5000",
      "",
      "    wg.Add(numGoroutines)",
      "    for i := 0; i < numGoroutines; i++ {",
      "        go func() {",
      "            defer wg.Done()",
      "            // ä½¿ç”¨ atomic.AddInt64 ä¿è­‰æ“ä½œçš„åŸå­æ€§",
      "            atomic.AddInt64(&counter, 1)",
      "        }()",
      "    }",
      "    wg.Wait()",
      "",
      '    fmt.Printf("é æœŸè¨ˆæ•¸ç‚º: %d\\n", numGoroutines)',
      '    fmt.Printf("ä½¿ç”¨ Atomic çš„å¯¦éš›çµæœ: %d (çµæœæ­£ç¢º)\\n", counter)',
      '    fmt.Println("åˆ†æ: Atomic æ“ä½œç”±ç¡¬é«”å±¤ç´šä¿è­‰ä¸å¯ä¸­æ–·ï¼Œæ•ˆç‡é«˜ä¸”èƒ½ç¢ºä¿çµæœæ­£ç¢ºã€‚")',
      "}",
      "",
      "// ==================================================",
      "// 3. ç·´ç¿’é¡Œ 4: ä½¿ç”¨ Mutex (äº’æ–¥é–) è§£æ±ºç«¶çˆ­æ¢ä»¶",
      "// ==================================================",
      "type SafeCounter struct {",
      "    mu    sync.Mutex",
      "    value int",
      "}",
      "",
      "func (c *SafeCounter) Increment() {",
      "    c.mu.Lock()",
      "    defer c.mu.Unlock()",
      "    c.value++",
      "}",
      "",
      "func demoMutex() {",
      '    printTitle("3. Mutex äº’æ–¥é–è§£æ±ºæ–¹æ¡ˆ (ç·´ç¿’é¡Œ 4)")',
      "    counter := SafeCounter{}",
      "    var wg sync.WaitGroup",
      "    numGoroutines := 5000",
      "",
      "    wg.Add(numGoroutines)",
      "    for i := 0; i < numGoroutines; i++ {",
      "        go func() {",
      "            defer wg.Done()",
      "            counter.Increment()",
      "        }()",
      "    }",
      "    wg.Wait()",
      "",
      '    fmt.Printf("é æœŸè¨ˆæ•¸ç‚º: %d\\n", numGoroutines)',
      '    fmt.Printf("ä½¿ç”¨ Mutex çš„å¯¦éš›çµæœ: %d (çµæœæ­£ç¢º)\\n", counter.value)',
      '    fmt.Println("åˆ†æ: Mutex é€éé–å®šæ©Ÿåˆ¶ï¼Œç¢ºä¿ä¸€æ¬¡åªæœ‰ä¸€å€‹ goroutine èƒ½é€²å…¥è‡¨ç•Œå€ (critical section) ä¿®æ”¹å€¼ã€‚")',
      "}",
      "",
      "// ==================================================",
      "// 4. Channel çš„å„ç¨®ç”¨æ³•",
      "// ==================================================",
      "func demoChannels() {",
      '    printTitle("4. Channel ç”¨æ³•å±•ç¤º")',
      "",
      "    // Unbuffered Channel (ç„¡ç·©è¡)",
      "    unbufChan := make(chan string)",
      "    go func() {",
      "        // å‚³é€æ–¹æœƒé˜»å¡ï¼Œç›´åˆ°æ¥æ”¶æ–¹æº–å‚™å¥½",
      '        unbufChan <- "Hello Unbuffered!"',
      '        fmt.Println("Unbuffered: å·²å‚³é€è³‡æ–™")',
      "    }()",
      "    time.Sleep(1 * time.Second) // æ¨¡æ“¬ä¸€äº›å»¶é²ï¼Œè­‰æ˜å‚³é€æ–¹åœ¨ç­‰å¾…",
      '    fmt.Println("Unbuffered: æº–å‚™æ¥æ”¶è³‡æ–™...")',
      "    msg := <-unbufChan",
      '    fmt.Printf("Unbuffered: æ”¶åˆ°è¨Šæ¯: %q\\n\\n", msg)',
      "",
      "    // Buffered Channel (æœ‰ç·©è¡)",
      "    bufChan := make(chan int, 2)",
      "    // å‚³é€æ–¹ä¸æœƒé˜»å¡ï¼Œå› ç‚ºç·©è¡å€é‚„æœ‰ç©ºé–“",
      "    bufChan <- 1",
      "    bufChan <- 2",
      '    fmt.Println("Buffered: å·²å‚³é€ 2 å€‹å€¼ï¼Œå› ç‚ºç·©è¡å€å¤ å¤§ï¼Œæ‰€ä»¥æ²’æœ‰é˜»å¡ã€‚")',
      "",
      '    fmt.Printf("Buffered: æ”¶åˆ°å€¼: %d\\n", <-bufChan)',
      '    fmt.Printf("Buffered: æ”¶åˆ°å€¼: %d\\n\\n", <-bufChan)',
      "",
      "    // Unidirectional Channel (å–®å‘é€šé“)",
      "    biChan := make(chan string) // é›™å‘é€šé“",
      "    // å‡½å¼ producer åªæ¥å— send-only channel",
      "    go producer(biChan)",
      "    // å‡½å¼ consumer åªæ¥å— receive-only channel",
      "    consumer(biChan)",
      "}",
      "",
      "// producer å‡½å¼åªèƒ½å‘ channel å‚³é€è³‡æ–™",
      "func producer(ch chan<- string) {",
      '    ch <- "Hello Unidirectional!"',
      "}",
      "",
      "// consumer å‡½å¼åªèƒ½å¾ channel æ¥æ”¶è³‡æ–™",
      "func consumer(ch <-chan string) {",
      "    msg := <-ch",
      '    fmt.Printf("Unidirectional: æ”¶åˆ°è¨Šæ¯: %q\\n", msg)',
      "}",
      "",
      "// ==================================================",
      "// 5. Select çš„å¤šè·¯è¤‡ç”¨èˆ‡è¶…æ™‚",
      "// ==================================================",
      "func demoSelect() {",
      '    printTitle("5. Select ç”¨æ³•å±•ç¤º")',
      "    ch1 := make(chan string)",
      "    ch2 := make(chan string)",
      "",
      "    go func() {",
      "        time.Sleep(1 * time.Second)",
      '        ch1 <- "ä¾†è‡ª ch1 çš„è¨Šæ¯"',
      "    }()",
      "    go func() {",
      "        time.Sleep(2 * time.Second)",
      '        ch2 <- "ä¾†è‡ª ch2 çš„è¨Šæ¯"',
      "    }()",
      "",
      "    // Select æœƒç­‰å¾…å¤šå€‹ channel",
      "    for i := 0; i < 2; i++ {",
      "        select {",
      "        case msg1 := <-ch1:",
      '            fmt.Printf("Select: æ”¶åˆ°: %s\\n", msg1)',
      "        case msg2 := <-ch2:",
      '            fmt.Printf("Select: æ”¶åˆ°: %s\\n", msg2)',
      "        case <-time.After(3 * time.Second):",
      '            fmt.Println("Select: ç­‰å¾…è¶…é 3 ç§’ï¼Œè¶…æ™‚äº†ï¼")',
      "        }",
      "    }",
      "}",
      "",
      "// ==================================================",
      "// 6. WaitGroup ç­‰å¾… Goroutine å®Œæˆ",
      "// ==================================================",
      "func worker(id int, wg *sync.WaitGroup) {",
      "    defer wg.Done()",
      '    fmt.Printf("Worker %d: é–‹å§‹å·¥ä½œ\\n", id)',
      "    time.Sleep(time.Second)",
      '    fmt.Printf("Worker %d: å·¥ä½œå®Œæˆ\\n", id)',
      "}",
      "",
      "func demoWaitGroup() {",
      '    printTitle("6. WaitGroup å±•ç¤º")',
      "    var wg sync.WaitGroup",
      "",
      "    for i := 1; i <= 3; i++ {",
      "        wg.Add(1)",
      "        go worker(i, &wg)",
      "    }",
      "",
      '    fmt.Println("Main: ç­‰å¾…æ‰€æœ‰ Worker å®Œæˆ...")',
      "    wg.Wait()",
      '    fmt.Println("Main: æ‰€æœ‰ Worker éƒ½å·²å®Œæˆå·¥ä½œï¼")',
      "}",
      "",
      "// ==================================================",
      "// 7. Context æ§åˆ¶ Goroutine çš„ç”Ÿå‘½é€±æœŸ",
      "// ==================================================",
      "func contextWorker(ctx context.Context, name string) {",
      "    for {",
      "        select {",
      "        case <-ctx.Done():",
      '            fmt.Printf("%s: æ”¶åˆ°å–æ¶ˆä¿¡è™Ÿï¼Œæº–å‚™é€€å‡ºã€‚\\n", name)',
      "            return",
      "        default:",
      '            fmt.Printf("%s: æ­£åœ¨å·¥ä½œ...\\n", name)',
      "            time.Sleep(1 * time.Second)",
      "        }",
      "    }",
      "}",
      "",
      "func demoContext() {",
      '    printTitle("7. Context å±•ç¤º")',
      "    ctx, cancel := context.WithCancel(context.Background())",
      "",
      '    go contextWorker(ctx, "Worker-A")',
      '    go contextWorker(ctx, "Worker-B")',
      "",
      '    fmt.Println("Main: å•Ÿå‹•äº†å…©å€‹ workerï¼Œç­‰å¾… 3 ç§’å¾Œç™¼å‡ºå–æ¶ˆä¿¡è™Ÿ...")',
      "    time.Sleep(3 * time.Second)",
      "",
      '    fmt.Println("Main: ç™¼å‡ºå–æ¶ˆä¿¡è™Ÿï¼")',
      "    cancel()",
      "",
      "    time.Sleep(1 * time.Second)",
      '    fmt.Println("Main: ç¨‹å¼çµæŸã€‚")',
      "}",
      "",
      "// ==================================================",
      "// 8. ç·´ç¿’é¡Œ 5: nil channel é€ æˆçš„ Deadlock",
      "// ==================================================",
      "func demoNilChannelError() {",
      '    printTitle("8. ç·´ç¿’é¡Œ 5: nil channel éŒ¯èª¤")',
      "    fmt.Println(\"ä¸‹é¢çš„ç¨‹å¼ç¢¼è¢«è¨»è§£æ‰äº†ï¼Œå› ç‚ºå®ƒæœƒå°è‡´ panicã€‚\")",
      "    fmt.Println(\"éŒ¯èª¤åŸå› : `var intChan chan int` åªæ˜¯å®£å‘Šï¼Œå…¶å€¼ç‚º nilã€‚å° nil channel çš„æ“ä½œæœƒæ°¸ä¹…é˜»å¡ã€‚\")",
      "    fmt.Println(\"ä¿®æ­£æ–¹æ³•: ä½¿ç”¨ make é€²è¡Œåˆå§‹åŒ–ã€‚\")",
      "    intChanCorrect := make(chan int, 1)",
      "    intChanCorrect <- 10",
      '    fmt.Printf("ä¿®æ­£å¾Œ: æˆåŠŸå‘ channel å¯«å…¥å€¼ %d\\n", <-intChanCorrect)',
      "}",
      "",
      "// ==================================================",
      "// 9. ç·´ç¿’é¡Œ 6: time.After çš„æ½›åœ¨å…§å­˜æ´©æ¼èˆ‡ä¿®æ­£",
      "// ==================================================",
      "func demoTimeAfterLeak() {",
      '    printTitle("9. ç·´ç¿’é¡Œ 6: time.After é¢¨éšªèˆ‡ä¿®æ­£")',
      "    ch := make(chan bool)",
      "",
      '    fmt.Println("æƒ…å¢ƒ: åœ¨ä¸€å€‹è¿´åœˆä¸­ä½¿ç”¨ time.After å¯èƒ½æœƒç”¢ç”Ÿè³‡æºæ´©æ¼ã€‚")',
      '    fmt.Println("å› ç‚ºå³ä½¿ ch å¾ˆå¿«æ”¶åˆ°ä¿¡è™Ÿï¼Œtime.After å‰µå»ºçš„è¨ˆæ™‚å™¨è³‡æºä¹Ÿè¦ç­‰åˆ°è¨ˆæ™‚çµæŸå¾Œæ‰èƒ½è¢«å›æ”¶ã€‚")',
      "",
      "    go func() {",
      "        time.Sleep(50 * time.Millisecond)",
      "        ch <- true",
      "    }()",
      "",
      "    // ä¸å¥½çš„ä½œæ³•",
      "    select {",
      "    case <-ch:",
      '        fmt.Println("time.After é¢¨éšª: é›–ç„¶å¾ˆå¿«æ”¶åˆ°äº† ch çš„ä¿¡è™Ÿï¼Œä½† time.After çš„è³‡æºä»åœ¨å¾Œå°ç­‰å¾…ã€‚")',
      "    case <-time.After(1 * time.Second):",
      '        fmt.Println("Timeout")',
      "    }",
      "",
      '    fmt.Println("\\nä¿®æ­£æ–¹æ³•: ä½¿ç”¨ time.NewTimerï¼Œä¸¦åœ¨ä¸éœ€è¦æ™‚è¨ˆæ™‚å‘¼å« Stop()ã€‚")',
      "    timer := time.NewTimer(1 * time.Second)",
      "",
      "    go func() {",
      "        time.Sleep(50 * time.Millisecond)",
      "        ch <- true",
      "    }()",
      "",
      "    select {",
      "    case <-ch:",
      '        fmt.Println("Timer ä¿®æ­£: æ”¶åˆ° ch çš„ä¿¡è™Ÿã€‚")',
      "    case <-timer.C:",
      '        fmt.Println("Timer ä¿®æ­£: è¶…æ™‚ã€‚")',
      "    }",
      "     // å¦‚æœæ²’èƒ½æˆåŠŸé˜»æ­¢è¨ˆæ™‚å™¨",
      "    if !timer.Stop() {",
      "     // é‚£å°±ä»£è¡¨ä¿¡ç®±è£¡ä¸€å®šæœ‰å°ä¿¡ï¼Œæˆ‘å€‘å°±ä¸»å‹•æŠŠé€™å°ä¿¡è®€å‡ºä¾†ä¸¦ä¸Ÿæ‰ï¼Œç¢ºä¿ä¿¡ç®±æ˜¯ä¹¾æ·¨çš„ï¼Œä»¥é˜²è¬ä¸€",
      "        <-timer.C",
      "    }",
      '    fmt.Println("Timer ä¿®æ­£: æ‰‹å‹•åœæ­¢è¨ˆæ™‚å™¨ï¼Œç¢ºä¿è³‡æºè¢«é‡‹æ”¾ã€‚")',
      "}",
      "```",
      "---"
    ].join("\n")
  },
    // *******************************************************************
  // *******************************************************************
  // *******************************************************************
  // *******************************************************************

  {
    id: "n-free5gc-lab2",
    slug: "free5gc-lab2-linux-kernel-networking-basics",
    title: "free5GC Lab2ï¼šLinux æ ¸å¿ƒä¸­çš„ç¶²è·¯åŸºç¤ï¼ˆip / netlink / sk_buff / NAPIï¼‰",
    date: "2025-09-07",
    category: "school-curriculum",
    tags: ["free5GC", "Linux", "Kernel", "Networking", "Netlink", "sk_buff", "NAPI", "iproute2", "Routing", "SoftIRQ", "L2", "L3", "PFCP"],
    cover: `${process.env.PUBLIC_URL}/free5gc.png`, // æœ‰åœ–å°±æ‰“é–‹ï¼›æ²’åœ–å¯ç•™ç©ºèµ°é è¨­
    summary:
      "ç†è§£ Linux æ ¸å¿ƒçš„ç¶²è·¯è³‡æ–™è·¯å¾‘ï¼šå¾ä¸­æ–·â†’NAPIâ†’sk_buff ä½‡åˆ—ã€L2/L3 æ”¶é€æµç¨‹ï¼Œåˆ°ä½¿ç”¨è€…ç©ºé–“é€é sysctl / ioctl / netlink èˆ‡æ ¸å¿ƒäº’å‹•ï¼›æ­é… ip(8) æŒ‡ä»¤èˆ‡ strace è§€å¯Ÿç³»çµ±å‘¼å«ã€‚",
    content: `
  # free5GC Lab

  GitHub Repoï¼š[free5GLab](https://github.com/free5gc/free5GLabs)

  > **æœ¬ Lab2 ç›®æ¨™**ï¼šç”¨ã€Œè§€å¯Ÿèˆ‡ç†è§£ã€ç‚ºä¸»ï¼Œå¸¶ä½ æŒæ¡ Linux æ ¸å¿ƒå¦‚ä½•è™•ç†ç¶²è·¯è¡Œç‚ºï¼ŒåŒ…å«è³‡æ–™çµæ§‹ï¼ˆ\\\`sk_buff\\\`ï¼‰ã€æ”¶é€è·¯å¾‘ã€ä½¿ç”¨è€…ç©ºé–“å¦‚ä½•é€é sysctl / ioctl / netlink èˆ‡æ ¸å¿ƒäº’å‹•ï¼Œä»¥åŠ \\\`ip\\\` æŒ‡ä»¤æ—èƒŒå¾Œçš„ç³»çµ±å‘¼å«ã€‚**é**è‘—é‡æ–¼å¯¦ä½œå¤§å‹ç³»çµ±ï¼Œå¯¦å‹™ free5GC è³‡æ–™å¹³é¢å¯åƒè€ƒ gtp5g ç›¸é—œæ–‡ä»¶ã€‚

  **å»¶ä¼¸é–±è®€ï¼ˆfree5GC / gtp5gï¼‰**  
  1) [gtp5g Architecture](https://free5gc.org/guide/Gtp5g/design/#introduction)  
  2) [gtp5g PFCP Architecture](https://free5gc.org/guide/Upf_PFCP/design/) 
  3) [Introduction to gtp5g and kernel concepts](https://free5gc.org/blog/20230920/Introduction_of_gtp5g_and_some_kernel_concepts/)  
  4) [gtp5g åŸå§‹ç¢¼è§£èªª](https://ithelp.ithome.com.tw/articles/10302887)

  ---

  ## 1. å¯¦é©—ç›®æ¨™ï¼ˆGoalsï¼‰

  - äº†è§£ Linux æ ¸å¿ƒåœ¨ L2/L3/L4 å°å°åŒ…çš„è™•ç†æµç¨‹ï¼ˆæ”¶åŒ…ã€å‚³åŒ…ã€è½‰é€ã€ä½‡åˆ—ã€åˆ†ç‰‡/çµ„è£ã€æª¢æŸ¥ç­‰ï¼‰ã€‚
  - èªè­˜é—œéµè³‡æ–™çµæ§‹ï¼š**\\\`sk_buff\\\`**ï¼ˆç¶²è·¯å­ç³»çµ±ä¸­æœ€å¸¸é…ç½®/é‡‹æ”¾çš„çµæ§‹ï¼‰ã€‚
  - å­¸æœƒè§€å¯Ÿ **ä½¿ç”¨è€…ç©ºé–“ â†” æ ¸å¿ƒç©ºé–“** çš„äº’å‹•æ–¹å¼ï¼š**sysctlã€ioctlã€netlink**ã€‚
  - ä»¥ **\\\`ip\\\` æŒ‡ä»¤æ—ï¼ˆiproute2ï¼‰** æ­é… **\\\`strace\\\`** è¿½è¹¤ç³»çµ±å‘¼å«ï¼Œç†è§£å…¶èƒŒå¾Œçš„ netlink è¨Šæ¯äº¤æ›ã€‚
  - æ•´ç† L2/L3 ä¹‹ **NAPIã€softirqã€ksoftirqdã€qdiscã€dev_queue_xmitã€netfilter hooksã€è·¯ç”±æŸ¥è¡¨** ç­‰è¦é»ã€‚

  > æœ¬ Lab å´é‡ã€Œè§€å¯Ÿï¼ç­†è¨˜ã€ï¼Œä½ å¯ä»¥æŠŠå®ƒç•¶ä½œ free5GC UPF è³‡æ–™å¹³é¢ï¼ˆgtp5gï¼‰çš„å‰ç½®çŸ¥è­˜åœ°åœ–ã€‚

  ---

  ## 2. æ ¸å¿ƒçŸ¥è­˜é»ï¼ˆCheat Sheetï¼‰

  - **\\\`sk_buff\\\`**ï¼šæ¯å€‹å°åŒ…ä¸€å€‹ \\\`sk_buff\\\`ã€‚å…§å«æŒ‡å‘è³‡æ–™å€å¡Šçš„ \\\`head/data/tail/end\\\`ï¼Œé•·åº¦ã€åˆ†ç‰‡è³‡è¨Šã€æ‰€å±¬è£ç½® \\\`dev\\\`ã€ç§æœ‰æ§åˆ¶å€ \\\`cb\\\`ã€å”å®šæ¬„ä½ \\\`protocol\\\`ã€QoS \\\`priority\\\` ç­‰ã€‚
  - **ä½¿ç”¨è€…ç©ºé–“ â†” æ ¸å¿ƒç©ºé–“**ï¼š  
    - **sysctl**ï¼šè®€/æ”¹æ ¸å¿ƒè®Šæ•¸ï¼ˆå¦‚ \\\`/proc/sys/net/ipv4/ip_forward\\\`ï¼‰ã€‚  
    - **ioctl**ï¼šå‚³çµ±è£ç½®æ§åˆ¶ä»‹é¢ï¼ŒåŠŸèƒ½å¼·ä½†æ ¼å¼ä¸å½ˆæ€§ã€‚  
    - **netlink**ï¼šé¢å‘ç¶²è·¯è¨­å®š/äº‹ä»¶çš„è¨Šæ¯å¼é€šé“ï¼Œæ”¯æ´å¤šæ’­ã€å½ˆæ€§å±¬æ€§ã€å¯é å‚³éï¼Œæ˜¯ iproute2 èˆ‡æ ¸å¿ƒå°è©±çš„ä¸»åŠ›ã€‚
  - **\\\`ip\\\` æŒ‡ä»¤æ—**ï¼š  
    - \\\`ip link\\\`ï¼ˆä»‹é¢ï¼‰ã€\\\`ip addr\\\`ï¼ˆä½å€ï¼‰ã€\\\`ip route\\\`ï¼ˆè·¯ç”±ï¼‰ã€\\\`ip neigh\\\`ï¼ˆARP/NDISCï¼‰ã€\\\`ip rule\\\`ï¼ˆPBRï¼‰ã€‚  
    - å…§éƒ¨å¤šä»¥ **netlinkï¼ˆNETLINK_ROUTEï¼‰** èˆ‡æ ¸å¿ƒæºé€šã€‚
  - **ä¸­æ–·â†’è»Ÿä¸­æ–·ï¼ˆsoftirqï¼‰â†’NAPI**ï¼š  
    NIC è§¸ç™¼ IRQ â†’ é©…å‹• ISR ç•¥è™•ç†å¾Œæ’ç¨‹ **NET_RX_SOFTIRQ** â†’ NAPI æ··åˆä¸­æ–·/è¼ªè©¢é™ä½é«˜è² è¼‰ IRQ é¢¨æš´ï¼Œksoftirqd æ¯ CPU åŸ·è¡Œå»¶å¾Œå·¥ä½œã€‚
  - **L2 / L3 æ··æ­é‡é»**ï¼š  
    - L2 æ”¶åŒ…ï¼šé©…å‹•æŠŠ frame è¤‡è£½åˆ° \\\`sk_buff\\\`ï¼Œè¨­å®š \\\`skb->protocol\\\`ï¼Œæ’ç¨‹ RX softirqï¼Œæ”¾å…¥æ¯ CPU çš„ \\\`softnet_data\\\`ã€‚  
    - L2 é€åŒ…ï¼š\\\`dev_queue_xmit\\\` é€é qdisc æˆ–ç›´æ¥ä¸Ÿçµ¦ \\\`hard_start_xmit\\\`ï¼Œä¸è¶³è³‡æºæ™‚ä»¥ \\\`netif_stop_queue\\\` åœä½‡åˆ—ã€‚  
    - L3 æ”¶åŒ…ï¼š\\\`ip_rcv\\\` åš sanity checkâ†’NF\_HOOK(PREROUTING)â†’è·¯ç”±åˆ¤æ–·ï¼šæœ¬æ©Ÿ/è½‰é€â†’\\\`ip_rcv_finish\\\`ã€‚  
    - L3 è½‰é€ï¼š\\\`ip_forward\\\`ï¼ˆéæ¸› TTLã€ä¾ MTU åˆ†ç‰‡ï¼‰â†’\\\`ip_forward_finish\\\`â†’é€å‡ºã€‚

  ---

  ## 3. é‡è¦è³‡æ–™çµæ§‹ï¼š\\\`sk_buff\\\`

  > æ¯å€‹å°åŒ…éƒ½æœ‰è‡ªå·±çš„ \\\`sk_buff\\\`ã€‚å®šç¾©æ–¼ \\\`include/linux/skbuff.h\\\`ï¼›ç”Ÿå‘½é€±æœŸè·¨ L2~L4ï¼Œå„å±¤æœƒæ”¹å‹•å…¶æ¬„ä½æˆ–å‰ç½®/å‰é™¤æ¨™é ­ã€‚

  ### è¨˜æ†¶é«”ä½ˆå±€ï¼ˆæ¦‚å¿µç¤ºæ„ï¼‰

  \`\`\` text
                                  ---------------
                                | sk_buff       |
                                  ---------------
    ,---------------------------  + head
    /          ,-----------------  + data
  /          /      ,-----------  + tail
  |          |      |            , + end
  |          |      |           |
  v          v      v           v
  -----------------------------------------------
  | headroom | data |  tailroom | skb_shared_info |
  -----------------------------------------------
                                + [page frag] ...
                                + frag_list  -->  sk_buff
  \`\`\`

  - \\\`sk_buff_head\\\` + \\\`sk_buff\\\` çµ„æˆé›™å‘éˆçµä¸²åˆ—ï¼Œä»£è¡¨æ”¶/é€ä½‡åˆ—ï¼ˆRX/TXï¼‰ã€‚  
  - é‡è¦æ¬„ä½æ‘˜éŒ„ï¼š  
    - **éˆçµ**ï¼š\\\`next/prev\\\`  
    - **æ‰€å±¬ socket/è£ç½®**ï¼š\\\`sk\\\`ï¼ˆL4 éœ€è¦æ™‚ï¼‰ã€\\\`dev\\\`ï¼ˆæ”¶ï¼šé©…å‹•å¡«å…¥å…¥ç«¯ä»‹é¢ï¼›é€ï¼šä¾è™›æ“¬/å¯¦é«”è£ç½®è½‰æ›å¯èƒ½è®Šå‹•ï¼‰  
    - **è³‡æ–™æŒ‡æ¨™/é•·åº¦**ï¼š\\\`head/data/tail/end\\\`ã€\\\`len\\\`ã€\\\`data_len\\\`  
    - **æ§åˆ¶å€ \\\`cb\\\`ï¼ˆ48 bytesï¼‰**ï¼šå„å±¤è‡¨æ™‚è³‡è¨Šå„²å­˜ï¼Œä¾‹å¦‚ \\*IP\_CB*ã€\\*TCP\_SKB\_CB*ã€‚  
    - **å”å®š/QoS**ï¼š\\\`protocol\\\`ï¼ˆä¸Šå±¤ demuxï¼‰ã€\\\`priority\\\`ï¼ˆQoSï¼‰ï¼Œ\\\`mark\\\` ç­‰ã€‚  
    - **åˆ†ç‰‡/æ ¡é©—**ï¼š\\\`frag_list\\\`ã€\\\`gso_size\\\`ã€\\\`csum\\\` ç­‰ã€‚

  **\\\`cb\\\` ä½¿ç”¨ç¯„ä¾‹ï¼š**ï¼ˆæ¦‚å¿µï¼‰
  \`\`\`c
  #define TCP_SKB_CB(__skb) ((struct tcp_skb_cb *)&((__skb)->cb[0]))
  // tcb->seq, tcb->end_seq, tcb->flag ... ä¾› TCP å±¤åœ¨æ”¶é€è·¯å¾‘å­˜å–è‡¨æ™‚æ¬„ä½
  \`\`\`

  ---

  ## 4. ä½¿ç”¨è€…ç©ºé–“ â†” æ ¸å¿ƒç©ºé–“

  ### 4.1 sysctl
  - è®€å¯«æ ¸å¿ƒè®Šæ•¸ï¼šä¾‹å¦‚å•Ÿç”¨è·¯ç”±åŠŸèƒ½  
    \`\`\`bash
    sudo sysctl -w net.ipv4.ip_forward=1
    # å°æ‡‰æª”æ¡ˆï¼š/proc/sys/net/ipv4/ip_forward
    \`\`\`

  ### 4.2 ioctlï¼ˆinput/output controlï¼‰
  - æ—©æœŸå¸¸ç”¨æ–¼ç¶²è·¯/è£ç½®æ§åˆ¶çš„ç³»çµ±å‘¼å«ï¼ŒåŠŸèƒ½å¼·ä½†åœ¨è¤‡é›œè³‡æ–™çµæ§‹å‚³éä¸Šè¼ƒä¸å½ˆæ€§ã€‚

  ### 4.3 netlinkï¼ˆæ¨è–¦ï¼‰
  - å°ˆç‚ºç¶²è·¯è¨­å®š/äº‹ä»¶è¨­è¨ˆçš„è¨Šæ¯å¼ IPCï¼š**å¯é ã€å¯å¤šæ’­ã€å±¬æ€§å½ˆæ€§**ã€‚  
  - å…¸å‹æµç¨‹ï¼š
    \`\`\`c
    fd = socket(AF_NETLINK, SOCK_RAW, NETLINK_GENERIC /*æˆ– NETLINK_ROUTE*/);
    send(fd, &request, sizeof(request));
    recv(fd, &response, RSP_BUFFER_SIZE);
    \`\`\`
  - è¨Šæ¯æ¨™é ­ï¼š
    \`\`\`c
    struct nlmsghdr {
      __u32 nlmsg_len;
      __u16 nlmsg_type;
      __u16 nlmsg_flags;
      __u32 nlmsg_seq;
      __u32 nlmsg_pid;  // å‚³é€ç«¯ port IDï¼ˆé€šå¸¸æ˜¯ PIDï¼‰
    };
    \`\`\`
    > **æ³¨æ„**ï¼šå¤šæ’­ç¾¤çµ„æ˜¯ \\\`sockaddr_nl\\\`ï¼ˆbind/connect æ™‚ï¼‰çš„ \\\`nl_groups\\\`ï¼Œ**ä¸æ˜¯** \\\`nlmsghdr\\\` æ¬„ä½ã€‚
  - å¸¸è¦‹æ—ç¾¤ï¼š
    - **NETLINK_ROUTE**ï¼šä»‹é¢/è·¯ç”±/é„°å±…/æµé‡æ§åˆ¶
    - **NETLINK_NETFILTER**ï¼šé˜²ç«ç‰†/å°åŒ…è™•ç†
    - **NETLINK_KOBJECT_UEVENT**ï¼šæ ¸å¿ƒäº‹ä»¶é€šçŸ¥
    - **NETLINK_GENERIC**ï¼šè‡ªå®šæ—ç¾¤

  **ioctl vs netlink**ï¼ˆç°¡è¨˜ï¼‰  
  ioctlï¼šå‘½ä»¤å¼ã€ä¸€å°ä¸€ã€æ ¼å¼åå›ºå®šï¼›  
  netlinkï¼šè¨Šæ¯å¼ã€å¤šæ’­ã€å±¬æ€§åŒ–ã€æ“…é•·è¤‡é›œæ‹“æ’²èˆ‡æ‰¹æ¬¡æŸ¥è©¢ï¼ˆiproute2 å³ä»¥æ­¤ç‚ºä¸»ï¼‰ã€‚

  ---

  ## 5. \\\`ip\\\` æŒ‡ä»¤æ—èˆ‡ strace è§€å¯Ÿ

  ### å¸¸è¦‹å­å‘½ä»¤
  - **\\\`ip link\\\`**ï¼šåˆ—ç¤º/è¨­å®šç¶²è·¯ä»‹é¢ï¼ˆUP/DOWNã€MTUã€å»ºç«‹ veth/bridge...ï¼‰
  - **\\\`ip addr\\\`**ï¼šæŒ‡æ´¾/åˆªé™¤ IPã€é¡¯ç¤ºä½å€
  - **\\\`ip route\\\`**ï¼šç®¡ç†è·¯ç”±è¡¨
  - **\\\`ip neigh\\\`**ï¼šARP / NDISC
  - **\\\`ip rule\\\`**ï¼šPBRï¼ˆç­–ç•¥å¼è·¯ç”±ï¼Œæ±ºå®šæŸ¥å“ªå¼µè¡¨ï¼‰ï¼›\\\`ip route\\\` æ˜¯åœ¨ **æŸå¼µè¡¨** è£¡æ–°å¢/æŸ¥è©¢è·¯ç”±

  > **å¤šæ•¸ \\\`ip\\\` å­å‘½ä»¤éƒ½æœƒé€é \\\`NETLINK_ROUTE\\\` èˆ‡æ ¸å¿ƒäº’å‹•ã€‚**

  ### 5.1 å¿«é€Ÿé«”é©—ï¼ˆå»ºè­°ç”¨éç”Ÿç”¢ VMï¼‰

  \`\`\`bash
  # åƒ…å°å‡ºèˆ‡ netlink äº’å‹•ç›¸é—œçš„ç³»çµ±å‘¼å«
  strace -e socket,bind,getsockopt,setsockopt,sendto,sendmsg,recvmsg ip link show

  # å°‡ä»‹é¢æ‰“é–‹
  sudo strace -e getsockopt,setsockopt,bind,sendto,recvmsg ip link set enp0s3 up

  # é¡¯ç¤ºä½å€
  sudo strace -e socket,setsockopt,bind,sendto,recvmsg ip addr show

  # æ–°å¢è·¯ç”±ï¼ˆç¤ºä¾‹ï¼šç¶“ enp0s8 ç›´é€£ 192.168.55.0/24ï¼‰
  sudo strace -e socket,setsockopt,sendmsg,recvmsg ip route add 192.168.55.0/24 dev enp0s8
  \`\`\`

  **è§£è®€é‡é»**  
  - \\\`socket(AF_NETLINK, SOCK_RAW, NETLINK_ROUTE)\\\`ï¼šip(8) èˆ‡æ ¸å¿ƒé–‹ netlinkã€‚  
  - \\\`setsockopt SOL_NETLINK NETLINK_EXT_ACK\\\`ï¼šé–‹å•Ÿæ“´å…… ACKã€‚  
  - \\\`bind(... nl_groups=00000000)\\\`ï¼šç¶å®š netlinkï¼Œé¸æ“‡è¨‚é–±ç¾¤çµ„ï¼ˆå¤šç‚º 0ï¼‰ã€‚  
  - \\\`sendmsg/recvmsg\\\`ï¼šç™¼é€/æ¥æ”¶ netlink è¨Šæ¯ï¼ˆå¦‚ \\\`RTM_GETLINK\\\`ã€\\\`RTM_NEWLINK\\\`ã€\\\`RTM_NEWROUTE\\\`ï¼‰ã€‚  
  - \\\`ip rule show\\\` èˆ‡ \\\`ip route show table <tbl>\\\` å¯å°ç…§ PBR èˆ‡å¯¦éš›è·¯ç”±è¡¨å…§å®¹ã€‚

  ---

  ## 6. æ ¸å¿ƒå¦‚ä½•ã€Œæ”¶åŒ…/é€åŒ…ã€

  ### 6.1 ä¸­æ–·èˆ‡é©…å‹•ï¼ˆIRQ â†’ ISRï¼‰
  1. NIC æ”¶åˆ° frame ç”¢ç”Ÿ **IRQ**ã€‚  
  2. CPU åˆ‡å…¥ **ISR**ï¼ˆé©…å‹•å±¤ï¼‰ï¼Œé€²è¡Œæœ€å°åŒ–è™•ç†ï¼ˆå¿«é€²å¿«å‡ºï¼‰ã€‚  
  3. é©…å‹•å°‡è³‡æ–™æ”¾å…¥ \\\`sk_buff\\\`ã€è¨­å®šæ¬„ä½ï¼ˆå¦‚ \\\`skb->protocol\\\`ï¼‰ï¼Œä¸¦æ’ç¨‹ **NET_RX_SOFTIRQ**ï¼›frame é€²å…¥æ¯ CPU çš„ \\\`softnet_data\\\` ä½‡åˆ—ã€‚

  > **ç‚ºä½•è¦ softirqï¼Ÿ** è®“è€—æ™‚å·¥ä½œå»¶å¾Œåˆ°å¯è¢«æ’ç¨‹çš„ä¸Šä¸‹æ–‡åŸ·è¡Œï¼ˆ\\\`ksoftirqd/N\\\` æ¯ CPU ä¸€æ¢ï¼‰ï¼Œé™ä½ IRQ å ç”¨æ™‚é–“èˆ‡æŠ–å‹•ã€‚

  ### 6.2 NAPIï¼ˆNew APIï¼‰
  - æ··åˆã€Œä¸­æ–· + è¼ªè©¢ã€ï¼šé«˜è² è¼‰æ™‚æ¸›å°‘ IRQ é¢¨æš´ï¼Œé€é poll æ‰¹æ¬¡æ‹‰å–å°åŒ…ã€‚  
  - è¨­å‚™æœªæ¶ˆåŒ–å®Œä¸Šä¸€æ‰¹å°åŒ…å‰ï¼Œä¸å†è§¸ç™¼æ–°çš„ IRQã€‚

  ### 6.3 L2 æ”¶åŒ…é—œéµ
  - **é€šçŸ¥æ ¸å¿ƒï¼ˆèˆŠï¼‰**ï¼š\\\`netif_rx\\\`ï¼ˆå¤šåœ¨ä¸­æ–·ä¸Šä¸‹æ–‡ï¼Œå¯èƒ½æš«æ™‚é—œä¸­æ–·ï¼‰  
  - **é€šçŸ¥æ ¸å¿ƒï¼ˆæ–°ï¼‰**ï¼š**NAPI**ï¼ˆå»ºè­°ï¼‰  
  - **æ ¸å¿ƒå…¥å£**ï¼š\\\`netif_receive_skb\\\` â†’ demux â†’ ä¾ \\\`skb->protocol\\\` åˆ†æ´¾è‡³ L3ã€‚

  ### 6.4 L2 é€åŒ…é—œéµ
  - **é€å‡ºæ’ç¨‹**ï¼š\\\`dev_queue_xmit\\\`  
    - èµ° **qdisc**ï¼ˆQoS/æ’ç¨‹ï¼‰ï¼Œ\`qdisc_run\`ï¼›æˆ–  
    - ç›´æ¥å‘¼å«é©…å‹•çš„ \\\`hard_start_xmit\\\`ã€‚  
  - **ä½‡åˆ—æ§åˆ¶**ï¼šè³‡æºä¸è¶³ï¼ˆå¦‚ MTU å¤§å°å¿«å–ä¸å¤ ï¼‰â†’ \\\`netif_stop_queue\\\` æš«åœ egress ä½‡åˆ—ï¼›å¯ç”¨ \\\`netif_wake_queue\\\` æ¢å¾©ã€‚  
  - **NET_TX_SOFTIRQï¼\\\`net_tx_action\\\`**ï¼šè™•ç†å¯å»¶å¾Œçš„ TX ä»»å‹™ï¼›é€ç•¢ç”¨ \\\`dev_kfree_skb_irq\\\` é‡‹æ”¾ skbã€‚

  ---

  ## 7. L3ï¼ˆIPv4ï¼‰è™•ç†æµç¨‹

  ### 7.1 åˆå§‹åŒ–
  - \\\`ip_init\\\`ï¼šè¨»å†Šè™•ç†å™¨ã€åˆå§‹åŒ–è·¯ç”±å­ç³»çµ±ã€ç«¯é»ç®¡ç†ã€‚

  ### 7.2 èˆ‡ Netfilter çš„äº’å‹•
  - å¤šå€‹æ›é»ï¼ˆhooksï¼‰ï¼š**PREROUTING**ã€**INPUT**ã€**FORWARD**ã€**OUTPUT**ã€**POSTROUTING**ã€‚  
  - é˜²ç«ç‰†/NAT/ç­–ç•¥å¯èƒ½åœ¨é€™äº›é»æ”¹è®Šå°åŒ…å‘½é‹ã€‚

  ### 7.3 èˆ‡è·¯ç”±å­ç³»çµ±äº’å‹•
  - \\\`ip_route_input\\\`ï¼šæ±ºå®šæœ¬æ©Ÿéé€æˆ–è½‰é€ã€‚  
  - \\\`ip_route_output_flow\\\`ï¼šæŸ¥å‡ºä¸‹ä¸€è·³èˆ‡ egress è£ç½®ã€‚  
  - \\\`dst_pmtu\\\`ï¼šæŸ¥è©¢è·¯å¾‘ MTUï¼ˆPMTUï¼‰ï¼Œé¿å…ä¸å¿…è¦åˆ†ç‰‡ã€‚

  ### 7.4 æ”¶åŒ…è™•ç†ï¼ˆé—œéµç¨‹å¼ï¼‰
  - **å…¥å£**ï¼š\\\`ip_rcv\\\`  
    - å…ˆåš sanity check / checksum  
    - å‘¼å« **NF\_HOOK(PREROUTING)**  
    - äº¤ç”± \\\`ip_rcv_finish\\\` å®Œæˆå¾ŒçºŒï¼šåˆ¤æ–·ç™¼é€è‡³æœ¬æ©Ÿæˆ–ä¸‹ä¸€è·³ã€è™•ç† IP options

  ### 7.5 è½‰é€ï¼ˆForwardingï¼‰
  - \\\`ip_forward\\\`ï¼šæª¢æŸ¥èƒ½å¦è½‰é€ã€TTL--ã€ä¾ MTU åˆ†ç‰‡ã€é¸æ“‡ egress devã€‚  
  - \\\`ip_forward_finish\\\`ï¼šæª¢æŸ¥å®Œç•¢ï¼Œäº¤çµ¦ L2 èµ°é€å‡ºè·¯å¾‘ã€‚

  > **åˆ†ç‰‡æˆæœ¬**ï¼šCPU èˆ‡å»¶é²çš†ä¸Šå‡ï¼›å»ºè­°ä¾ **Path MTU Discovery** é¿å…åˆ†ç‰‡ï¼Œè·¯å¾‘ MTU æœƒç·©å­˜æ–¼è·¯ç”±é …ç›®ã€‚

  ---

  ## 8. å¯¦ä½œ/è§€å¯Ÿä»»å‹™ï¼ˆä¸€æ­¥ä¸€æ­¥åšï¼‰

  > å»ºè­°åœ¨ VM/å®¹å™¨é€²è¡Œï¼Œé¿å…å½±éŸ¿ä¸»æ©Ÿç¶²è·¯ï¼›å¤šæ•¸æŒ‡ä»¤éœ€ \\\`sudo\\\`ã€‚

  1. **è§€å¯Ÿä»‹é¢åˆ—è¡¨ï¼ˆ\\\`ip link show\\\`ï¼‰**  
    \`\`\`bash
    strace -e socket,bind,getsockopt,setsockopt,sendto,recvmsg ip link show
    \`\`\`  
    - ä½ æœƒçœ‹åˆ° \\\`NETLINK_ROUTE\\\` çš„ socket èˆ‡ \\\`RTM_GETLINK\\\` è¨Šæ¯ã€‚

  2. **å°‡ä»‹é¢æ‹‰èµ·ï¼ˆ\\\`ip link set <if> up\\\`ï¼‰**  
    \`\`\`bash
    sudo strace -e getsockopt,setsockopt,bind,sendto,recvmsg ip link set enp0s3 up
    \`\`\`  
    - æ ¸å¿ƒæ”¶åˆ° \\\`RTM_NEWLINK\\\`ï¼Œæ›´æ–°ä»‹é¢ stateã€‚

  3. **æª¢è¦–ä½å€ï¼ˆ\\\`ip addr show\\\`ï¼‰**  
    \`\`\`bash
    sudo strace -e socket,setsockopt,bind,sendto,recvmsg ip addr show
    \`\`\`

  4. **æ–°å¢ç›´é€£è·¯ç”±ï¼ˆ\\\`ip route add\\\`ï¼‰**  
    \`\`\`bash
    sudo strace -e socket,setsockopt,sendmsg,recvmsg \\
      ip route add 192.168.55.0/24 dev enp0s8
    \`\`\`  
    - å¯å†ç”¨ \\\`ip rule show\\\` èˆ‡ \\\`ip route show table main\\\` å°ç…§ã€‚

  5. **è§€å¯Ÿ softirq/ksoftirqd**  
    \`\`\`bash
    ps aux | grep soft
    # ä½ æ‡‰è©²æœƒçœ‹åˆ° [ksoftirqd/0], [ksoftirqd/1] ... æ¯ CPU ä¸€æ¢
    \`\`\`

  ---

  ## 9. å¸¸è¦‹å¯¦å‹™æ³¨æ„

  - **æ¬Šé™**ï¼šå¤šæ•¸ç¶²è·¯è¨­å®šéœ€ \\\`CAP_NET_ADMIN\\\`ï¼ˆsudoï¼‰ã€‚  
  - **MTU/PMTU**ï¼šéŒ¯èª¤ MTU æœƒå°è‡´åˆ†ç‰‡æˆ–é€šè¨Šå¤±æ•—ã€‚  
  - **loopback ç‰¹æ€§**ï¼š\\\`lo\\\` å¸¸ä¸ç¶“ qdiscã€‚  
  - **é«˜è² è¼‰ IRQ é¢¨æš´**ï¼šå•Ÿç”¨ NAPIã€èª¿æ•´ä¸­æ–·åˆä½µï¼ˆNIC åŠŸèƒ½ï¼‰ã€‚  
  - **é»åŒ…/æ‹†åŒ…**ï¼ˆæ‡‰ç”¨å±¤å”å®šï¼‰ï¼šè‹¥ä¸ç”¨ \\\`ReadString\\\` é¡ APIï¼Œéœ€è‡ªè¡Œå®šç¾©è¨Šæ¡†é‚Šç•Œï¼ˆé•·åº¦å‰ç¶´æˆ–åˆ†éš”ç¬¦ï¼‰ã€‚

  ---

  ## 10. æ€è€ƒé¡Œï¼ˆQuestionsï¼‰

  1. **ä»€éº¼æ˜¯ \\\`sk_buff\\\`ï¼Ÿ** è©³è¿°å…¶å„²å­˜è³‡è¨Šã€ç”¨é€”ï¼Œä»¥åŠåœ¨å“ªäº›å±¤ï¼ˆL2~L4ï¼‰è¢«ä½¿ç”¨ã€‚  
  2. **ä»€éº¼æ˜¯ Linux ç¶²è·¯ä¸­çš„ Netlinkï¼Ÿ** èªªæ˜å…¶ç›®çš„ã€å…¸å‹é€šè¨Šæµç¨‹ã€è¨Šæ¯æ ¼å¼ï¼Œä¸¦æ¯”è¼ƒ ioctl èˆ‡ netlink çš„å·®ç•°ã€‚  
  3. **èªªæ˜ \\\`ip\\\` æŒ‡ä»¤åœ¨ Linux ç¶²è·¯ç®¡ç†ä¸­çš„ä¸»è¦åŠŸèƒ½**ï¼Œä»¥åŠå®ƒæ˜¯é€éå“ªäº›ç³»çµ±å‘¼å«èˆ‡æ ¸å¿ƒäº’å‹•å®Œæˆå·¥ä½œçš„ã€‚  
  4. **è§£é‡‹ Linux ä¸­çš„ç¶²è·¯ç›¸é—œä¸­æ–·è™•ç†æµç¨‹**ï¼šè£ç½®ã€é©…å‹•ã€CPU èˆ‡æ ¸å¿ƒå„è‡ªçš„è§’è‰²ï¼›ä¸¦èªªæ˜ä»€éº¼æ˜¯ **softirq**ï¼Œä»¥åŠå®ƒåœ¨æ­¤è„ˆçµ¡ä¸­çš„é‡è¦æ€§ã€‚  
  5. **æè¿° L2 frame çš„è™•ç†æµç¨‹**ï¼šä½‡åˆ—ç®¡ç†ã€å¦‚ä½•é€šçŸ¥æ ¸å¿ƒã€æ¥æ”¶è™•ç†èˆ‡å‚³é€æ’ç¨‹ï¼ˆqdisc / \\\`dev_queue_xmit\\\`ï¼‰ã€‚  
  6. **èªªæ˜ L3 IP å°åŒ…è™•ç†**ï¼šåˆå§‹åŒ–ã€èˆ‡ Netfilter çš„äº’å‹•ã€è·¯ç”±æŸ¥è©¢ï¼Œä»¥åŠè½‰é€ï¼ˆ\\\`ip_forward\\\` / \\\`ip_forward_finish\\\`ï¼‰çš„éç¨‹ã€‚

  ---

  ## 11. åƒè€ƒæŒ‡å¼•ï¼ˆå·¥å…· & man pagesï¼‰

  - **man pages**ï¼š\\\`man 8 ip\\\`ã€\\\`man 7 netlink\\\`ã€\\\`man 2 ioctl\\\`ã€\\\`man 7 packet\\\`  
  - **åŸå§‹ç¢¼å…¥å£**ï¼š  
    - L2 æ ¸å¿ƒï¼š\\\`net/core/dev.c\\\`ï¼ˆ\\\`netif_receive_skb\\\`ã€\\\`dev_queue_xmit\\\` ç­‰ï¼‰  
    - IPv4ï¼š\\\`net/ipv4/ip_input.c\\\`ï¼ˆ\\\`ip_rcv\\\`ï¼‰ã€\\\`net/ipv4/ip_forward.c\\\`ï¼ˆ\\\`ip_forward\\\`ï¼‰  
  - **free5GC / gtp5g**ï¼šè¦‹æœ¬æ–‡èµ·å§‹çš„ 4 ä»½é€£çµ

  ---
  `
  },
      // *******************************************************************
  // *******************************************************************
  // *******************************************************************
  // *******************************************************************
{
  id: "n-free5gc-lab3",
  slug: "free5gc-lab3-deploy-with-docker-compose",
  title: "free5GC Lab3ï¼šç”¨ Docker Compose éƒ¨ç½²èˆ‡æ’éŒ¯ï¼ˆå« MongoDB/UPF/n6gwï¼‰",
  date: "2025-09-10",
  category: "school-curriculum",
  tags: ["free5GC", "5G", "Docker", "Docker Compose", "MongoDB", "GTP5G", "UERANSIM", "iptables", "NAT"],
  cover: `${process.env.PUBLIC_URL}/free5gc.png`,
  summary:
    "ä¸€æ­¥ä¸€æ­¥æŠŠ free5GC ç”¨ Docker Compose è·‘èµ·ä¾†ï¼Œè™•ç† MongoDBï¼ˆAVXï¼‰ã€UPF/n6gw è…³æœ¬æ¬Šé™èˆ‡ CRLFã€SNATã€PFCP/GTP-U å°åŒ…é©—è­‰ï¼Œä¸¦æä¾›å¸¸è¦‹éŒ¯èª¤å°ç…§èˆ‡å¥æª¢æ¸…å–®ã€‚",
  content: `
# free5GC Lab 3 éƒ¨ç½²ç­†è¨˜ï¼ˆæ­¥é©Ÿï¼‹å•é¡Œæ’æŸ¥ï¼‰

## TL;DRï¼ˆé€™æ¬¡ä¿®æ­£é‡é»ï¼‰

- **MongoDB æ›æ‰ï¼ˆç¼º AVXï¼‰** â†’ æŠŠ \\\`db\\\` æ”¹ç”¨ \\\`mongo:4.4\\\`ã€‚
- **UPF / n6gw \\\`Permission denied\\\`** â†’ å° \\\`upf-iptables.sh\\\`ã€\\\`n6gw_iptables.sh\\\` åŠ  \\\`+x\\\`ï¼Œä¸¦æŠŠ CRLF è½‰ LFã€‚
- **é‡å»ºæœå‹™** â†’ \\\`docker compose ... up -d --force-recreate\\\` å¾Œï¼ŒNRF/WEBUI/AMF/SMF å…¨éƒ¨æ¢å¾©ã€‚
- ï¼ˆå¯é¸ï¼‰ç§»é™¤ \\\`version: "3.8"\\\` è­¦å‘Šï¼Œä¸å½±éŸ¿åŠŸèƒ½ã€‚

---

## 0) å‰ç½®æª¢æŸ¥ï¼ˆå¼·çƒˆå»ºè­°å…ˆåšï¼‰

> é€™äº›æª¢æŸ¥èƒ½çœä¸‹ 80% æ’éŒ¯æ™‚é–“ã€‚

### 0.1 Host ç«¯ï¼ˆéå®¹å™¨ï¼‰  
\`\`\`bash
# CPU æ˜¯å¦æ”¯æ´ AVXï¼ˆè‹¥æ²’æœ‰ï¼ŒMongoDB 5.x æœƒç‚¸ï¼‰
lscpu | grep -i avx || echo "No AVX (use mongo:4.4)"

# å…§æ ¸ç‰ˆæœ¬èˆ‡ gtp5gï¼ˆUPF éœ€ï¼‰
uname -r
lsmod | grep gtp5g || echo "gtp5g not loaded"
# è‹¥æœªè¼‰å…¥ï¼šsudo modprobe gtp5g ï¼›è‹¥æ²’æœ‰æ¨¡çµ„éœ€å…ˆç·¨è­¯å®‰è£ï¼ˆåƒè€ƒ gtp5g å°ˆæ¡ˆï¼‰
\`\`\`

### 0.2 Netfilter/iptablesï¼ˆå®¹å™¨å…§æœƒèª¿ç”¨ï¼‰
\`\`\`bash
# æœ‰äº›ç’°å¢ƒé è¨­èµ° nftablesï¼Œè…³æœ¬è‹¥ç”¨ iptables-legacy éœ€åˆ‡å›ï¼ˆå¯è¦–æƒ…æ³ï¼‰
sudo update-alternatives --config iptables   # é¸æ“‡ iptables-legacyï¼ˆè‹¥è…³æœ¬éœ€è¦ï¼‰
\`\`\`

### 0.3 é˜²ç«ç‰†
\`\`\`bash
# è‹¥ Host é–‹äº† UFWï¼Œå»ºè­°æš«æ™‚é—œé–‰æˆ–æ”¾è¡Œå®¹å™¨æ©‹æ¥ç¶²ï¼ˆé¿å… PFCP/GTP-U è¢«æ“‹ï¼‰
sudo ufw status verbose
\`\`\`

---

## 1) æ‹“æ’²èˆ‡ IP è¦åŠƒï¼ˆæœ¬æ¬¡æ²¿ç”¨ï¼‰

- \\\`privnet\\\`ï¼ˆ10.100.200.0/24ï¼‰ï¼šSBIï¼ˆNRF/AMF/SMF/PCF/UDM/UDR/CHF/WebUI/MongoDBï¼‰  
- \\\`n2net\\\`ï¼ˆ10.100.2.0/24ï¼‰ï¼šAMF â†” gNBï¼ˆUERANSIMï¼‰  
- \\\`n3net\\\`ï¼ˆ10.100.3.0/24ï¼‰ï¼šgNB â†” UPFï¼ˆGTP-Uï¼‰  
- \\\`n4net\\\`ï¼ˆ10.100.4.0/24ï¼‰ï¼šSMF â†” UPFï¼ˆPFCPï¼‰  
- \\\`n6net\\\`ï¼ˆ10.100.6.0/24ï¼‰ï¼šUPF â†” n6gwï¼ˆDN å‡ºå£åš SNATï¼‰

> ä¾‹ï¼šUPF(N3)=10.100.3.100ã€UPF(N4)=10.100.4.100ã€UPF(N6)=10.100.6.100ã€SMF(N4)=10.100.4.20ã€AMF(N2)=10.100.2.20ã€UERANSIM gNB(N2/N3)=10.100.2.10/10.100.3.10

---

## 2) é€™æ¬¡å¯¦ä½œçš„å¯¦éš›è®Šæ›´

### 2.1 å°‡ MongoDB å›ºå®šç‰ˆæœ¬åˆ° 4.4ï¼ˆé¿å… AVX éœ€æ±‚ï¼‰

ç·¨è¼¯ \\\`deploy_exercise.yaml\\\` ä¸­çš„ \\\`db\\\` æœå‹™ï¼š
\`\`\`yaml
services:
  db:
    container_name: mongodb
    image: mongo:4.4   # â† åŸæœ¬æ˜¯ mongoï¼ˆ5.x éœ€ AVXï¼‰ï¼Œæ”¹æˆ 4.4
    command: mongod --port 27017
    expose: ["27017"]
    volumes: [ dbdata:/data/db ]
    networks:
      privnet:
        aliases: [ db ]
\`\`\`

> **è‹¥å…ˆå‰ç”¨éæ–°ç‰ˆ MongoDB çš„ volume**ï¼Œå»ºè­°æŠŠ \\\`dbdata\\\` æ¸…æ‰é‡å»ºï¼ˆé¿å…è³‡æ–™æª”æ ¼å¼ä¸ç›¸å®¹ï¼‰ï¼š
> \`\`\`bash
> docker compose -f deploy_exercise.yaml down -v   # æœƒåˆªå®¹å™¨ï¼‹volumeï¼ˆè¬¹æ…ï¼‰
> \`\`\`

### 2.2 ä¿®æ­£ iptables è…³æœ¬ä¸å¯åŸ·è¡Œ

åœ¨ \\\`~/free5gc-compose\\\`ï¼š
\`\`\`bash
chmod +x ./config/upf-iptables.sh ./config/n6gw_iptables.sh

# è‹¥æ›¾åœ¨ Windows ç·¨è¼¯ï¼Œé †æ‰‹å» CRLFï¼š
sed -i 's/\\r$//' ./config/upf-iptables.sh
sed -i 's/\\r$//' ./config/n6gw_iptables.sh
\`\`\`
> ä½ çš„ logï¼š\\\`Permission denied\\\`ï¼ˆexit 126ï¼‰å°±æ˜¯å› ç‚ºæ²’æœ‰ \\\`+x\\\` æˆ–è¡Œå°¾ CRLFã€‚

### 2.3ï¼ˆå¯é¸ï¼‰ç§»é™¤ Compose \\\`version\\\` è­¦å‘Š

æŠŠæª”é ­ \\\`version: "3.8"\\\` åˆªæ‰å³å¯ï¼ˆCompose v2 æœƒè‡ªå‹•åˆ¤æ–·ï¼‰ã€‚

### 2.4 é‡å»ºé—œéµæœå‹™

\`\`\`bash
docker compose -f deploy_exercise.yaml down
docker compose -f deploy_exercise.yaml up -d --force-recreate \\
  db nrf webui upf n6gw amf smf ausf udr udm pcf nssf chf ueransim
\`\`\`

---

## 3) å¥æª¢èˆ‡é©—è­‰ï¼ˆèµ·ä¾†å¾Œç«‹åˆ»æª¢æŸ¥ï¼‰

### 3.1 MongoDB æ˜¯å¦æ­£å¸¸
\`\`\`bash
docker logs -f mongodb | tail -n +1
# æœŸå¾…ï¼šæ²’æœ‰ AVX è­¦å‘Šï¼Œä¸¦å‡ºç¾ "Waiting for connections" é¡è¨Šæ¯
\`\`\`

### 3.2 NRF æ˜¯å¦ä¸å† 500 / server selection timeout
\`\`\`bash
docker logs -f nrf | egrep -i "error|500|timeout|Register" | tail -n 100
# æœŸå¾…ï¼šä¸å†çœ‹åˆ° "server selection timeout" / "connection refused"
\`\`\`

### 3.3 upf / n6gw è·¯ç”±èˆ‡ NAT æ˜¯å¦ç”Ÿæ•ˆ
\`\`\`bash
docker exec -it upf  bash -lc 'ip r; iptables -S | head'
docker exec -it n6gw bash -lc 'ip r; iptables -t nat -S | grep POSTROUTING'

# æœŸå¾…ï¼ˆUPFï¼‰ï¼šdefault via 10.100.6.101 dev dn0
# æœŸå¾…ï¼ˆn6gwï¼‰ï¼šå° 10.60.0.0/16ã€10.61.0.0/16 æœ‰ routeï¼›nat è¡¨æœ‰ MASQUERADE
\`\`\`

> **è£œå……ï¼š** åœ¨ n6gw å…§ç¢ºèªè½‰é€ã€åå‘è·¯ç”±æª¢æŸ¥  
> \`\`\`bash
> docker exec -it n6gw bash -lc 'sysctl -w net.ipv4.ip_forward=1; sysctl -w net.ipv4.conf.all.rp_filter=0'
> \`\`\`

### 3.4 N2 ä¿¡ä»¤ï¼ˆä½ å·²ç¶“æ­£å¸¸ï¼‰
AMF log æœƒçœ‹åˆ° \\\`Handle InitialUEMessage\\\`ã€\\\`RRC connection established\\\` ç­‰ã€‚

### 3.5 UE é€£ç·š & å‡ºç¶²æ¸¬è©¦
\`\`\`bash
docker exec -it ueransim bash
./nr-ue -c config/uecfg.yaml
ip a | grep uesimtun0 -n
ping -I uesimtun0 8.8.8.8
\`\`\`

> å¯ç”¨ \\\`traceroute -i uesimtun0 8.8.8.8\\\` çœ‹çœ‹æ˜¯å¦ç¶“é n6gw å‡ºå£ï¼›æˆ–ç”¨ \\\`iperf3\\\` åšååæ¸¬è©¦ã€‚

### 3.6 éœ€è¦æ™‚è§€å¯Ÿå°åŒ…
\`\`\`bash
# GTP-Uï¼ˆUPF ä¸Šï¼‰
docker exec -it upf bash -lc \\
 'apt-get update >/dev/null 2>&1; apt-get install -y tcpdump >/dev/null 2>&1 || true; tcpdump -ni any udp port 2152 -c 5'

# PFCPï¼ˆSMF/UPFï¼‰
docker exec -it upf bash -lc 'tcpdump -ni any udp port 8805 -c 5'
docker exec -it smf bash -lc 'tcpdump -ni any udp port 8805 -c 5'
\`\`\`

---

## 4) é€™æ¬¡é‡åˆ°çš„å•é¡Œèˆ‡è§£æ³•ï¼ˆå°ç…§éŒ¯èª¤è¨Šæ¯ï¼‰

### å•é¡Œ Aï¼šMongoDB AVX å°è‡´å®¹å™¨é€€å‡º
**ç—‡ç‹€**
\`\`\`
mongodb | WARNING: MongoDB 5.0+ requires a CPU with AVX support ...
mongodb exited with code 132
\`\`\`
**å½±éŸ¿**
- NRF/WEBUI/UDR/UDM/PCF/NSSF/SMF/AUSF éƒ½é€£ä¸åˆ° DB â†’
  \\\`server selection timeout\\\`ã€\\\`connection refused\\\`ã€\\\`server misbehaving\\\`ã€WEBUI login 500ã€AMFã€Œcan not select an AUSF by NRFã€â†’ UE è¨»å†Šè¢«æ‹’ï¼ˆCONGESTIONï¼‰ã€‚

**è§£æ³•**
- å°‡ \\\`db\\\` æ”¹ç”¨ \\\`image: mongo:4.4\\\`ï¼ˆä¸éœ€ AVXï¼‰ã€‚
- å¦‚æœ‰èˆŠ volumeï¼Œç æ‰ \\\`dbdata\\\` é‡ä¾†ã€‚

---

### å•é¡Œ Bï¼šUPF / n6gw è…³æœ¬ç„¡æ³•åŸ·è¡Œ
**ç—‡ç‹€**
\`\`\`
bash: line 1: ./n6gw-iptables.sh: Permission denied
bash: line 1: ./upf-iptables.sh: Permission denied
... exited with code 126
\`\`\`
**åŸå› **
- bind mount é€²å®¹å™¨çš„æª”æ¡ˆæ˜¯ä¸å¯åŸ·è¡Œï¼ˆç¼º \\\`+x\\\`ï¼‰æˆ– CRLF è¡Œå°¾ã€‚

**è§£æ³•**
\`\`\`bash
chmod +x ./config/upf-iptables.sh ./config/n6gw_iptables.sh
sed -i 's/\\r$//' ./config/upf-iptables.sh ./config/n6gw_iptables.sh
\`\`\`

---

### å•é¡Œ Cï¼šå¤§é‡ NRF 500 / WEBUI 500 / AMF é¸ä¸åˆ° AUSF
**ç—‡ç‹€**
\`\`\`
NRF ... server selection timeout / server misbehaving
WEBUI ... Login err ... server selection timeout
AMF ... can not select an AUSF by NRF
\`\`\`
**åŸå› **
- å•é¡Œ Aï¼ˆDB æ›ï¼‰é€£é–æ•ˆæ‡‰ã€‚

**è§£æ³•**
- å…ˆä¿® DBï¼ˆ\\\`mongo:4.4\\\`ï¼‰ï¼Œå…¶é¤˜è‡ªç„¶æ¢å¾©ã€‚

---

### ï¼ˆé™„åŠ ï¼‰å°å•é¡Œï¼š\\\`no such service: smf\\\`
**æƒ…å¢ƒ**
- \\\`docker compose logs smf\\\` å ±éŒ¯ã€‚

**èªªæ˜**
- Compose åƒæ•¸è¦ç”¨ **service åç¨±**ï¼ˆä¾‹å¦‚ \\\`free5gc-smf\\\`ï¼‰ï¼Œä¸æ˜¯ \\\`container_name\\\`ã€‚

**è§£æ³•**
\`\`\`bash
docker compose -f deploy_exercise.yaml config --services   # æŸ¥ service å
docker compose -f deploy_exercise.yaml logs -f free5gc-smf
# æˆ–ç›´æ¥ç”¨ container åç¨±ï¼š
docker logs -f smf
\`\`\`

---

## 5) äº¤ä»˜èˆ‡é©—æ”¶æ¸…å–®ï¼ˆä½ å·²å®Œæˆ âœ…ï¼‰

- [x] \\\`db\\\` ä½¿ç”¨ \\\`mongo:4.4\\\`ï¼ŒMongoDB æ­£å¸¸å•Ÿå‹•  
- [x] \\\`upf-iptables.sh\\\`ã€\\\`n6gw_iptables.sh\\\` å…·å‚™ \\\`+x\\\`ï¼Œä¸” LF è¡Œå°¾  
- [x] \\\`upf\\\` é è¨­è·¯ç”±ç¶“ \\\`dn0 â†’ 10.100.6.101\\\`ï¼›\\\`n6gw\\\` æœ‰ MASQUERADE  
- [x] NRF ç„¡ \\\`server selection timeout / 500\\\`  
- [x] AMF å¯æ‰¾åˆ° AUSF â†’ UE è¨»å†ŠæˆåŠŸ  
- [x] \\\`uesimtun0\\\` ä»‹é¢å­˜åœ¨ï¼Œå¯ \\\`ping -I uesimtun0 8.8.8.8\\\`  
- [x] éœ€è¦æ™‚è§€å¯Ÿåˆ° GTP-U(2152)/PFCP(8805) å°åŒ…

---

## 6) å¸¸ç”¨æŒ‡ä»¤é™„éŒ„

\`\`\`bash
# åˆ—å‡º service åç¨±
docker compose -f deploy_exercise.yaml config --services

# æŸ¥çœ‹æœå‹™ç¶²è·¯ IP
docker inspect upf | jq '.[0].NetworkSettings.Networks'
docker inspect smf | jq '.[0].NetworkSettings.Networks'
docker inspect amf | jq '.[0].NetworkSettings.Networks'
docker inspect ueransim | jq '.[0].NetworkSettings.Networks'

# åªçœ‹æŸäº›æœå‹™çš„ log
docker compose -f deploy_exercise.yaml logs -f --tail=200 free5gc-smf free5gc-upf free5gc-amf

# ç›´æ¥ç”¨ container åç¨±
docker logs -f smf upf amf

# æ•´å€‹ç’°å¢ƒé‡å»º
docker compose -f deploy_exercise.yaml down
docker compose -f deploy_exercise.yaml up -d --force-recreate
\`\`\`

---

## 7) é€²éšè£œå……èˆ‡ã€Œå¸¸è¦‹è¸©é›·ã€

- **rp_filter**ï¼šåœ¨åšéš§é“/å¤šè·¯ç”±æ™‚ï¼ŒLinux çš„åå‘è·¯ç”±æª¢æŸ¥å¯èƒ½æ“‹æ‰å›ç¨‹ã€‚å° **n6gw** åŠéœ€è¦å¤šè·¯ç”±çš„å®¹å™¨ï¼ˆè‹¥æœ‰ï¼‰è¨­ \\\`net.ipv4.conf.all.rp_filter=0\\\`ã€‚  
- **PBRï¼ˆç­–ç•¥è·¯ç”±ï¼‰**ï¼šè‹¥ DN å‡ºå£è¤‡é›œï¼Œå¯ç”¨ \\\`ip rule\\\` + \\\`ip route\\\` åˆ†æµï¼ˆä½†æœ¬ Lab é»˜èªä¸éœ€ï¼‰ã€‚  
- **MTU**ï¼šGTP-U å°è£æœƒåƒæ‰éƒ¨åˆ† MTUã€‚è‹¥è·¨ç¶²æ®µå‡ºç¶²ä¸ç©©å®šï¼Œå¯åœ¨ \\\`dn0\\\` æˆ–å°å¤–å£èª¿æ•´ MTUï¼Œæˆ–ç¢ºä¿è·¯å¾‘æ”¯æ´ PMTUã€‚  
- **å®¹å™¨æ™‚é˜**ï¼šNFs ä¹‹é–“çš„ JWT/TLS/Token èˆ‡æ—¥èªŒæ’åºéœ€æ™‚é–“ä¸€è‡´ï¼›Host NTP è¦æ­£å¸¸ã€‚  
- **æŒä¹…åŒ–è³‡æ–™**ï¼šMongoDB å‡/é™ç‰ˆæœ¬å¾Œï¼ŒèˆŠè³‡æ–™ä¸ç›¸å®¹æœƒé€ æˆå¥‡æ€ªçš„ 500ï¼›ä¸ç¢ºå®šæ™‚æ¸…ç©º volume é‡ä¾†æœ€ä¹¾æ·¨ã€‚  
- **iptables/nftables**ï¼šè…³æœ¬è‹¥ç”¨ \\\`iptables-legacy\\\`ï¼Œä½†ç³»çµ±æ˜¯ nftablesï¼Œè¦å‰‡å¯èƒ½æ²’çœŸæ­£ç”Ÿæ•ˆï¼›å¯ç”¨ \\\`iptables -S\\\` èˆ‡ \\\`nft list ruleset\\\` äº¤å‰ç¢ºèªã€‚  
- **Host é˜²ç«ç‰†/å®‰å…¨çµ„**ï¼šPFCP(8805)/GTP-U(2152) ä¸€å®šè¦é€šï¼›è‹¥åœ¨é›²ç«¯ VMï¼Œé‚„è¦æª¢æŸ¥é›²ç«¯é˜²ç«ç‰†è¦å‰‡ã€‚  
- **UERANSIM é…ç½®**ï¼š\\\`gnb.yaml\\\` çš„ N2/N3 IP è¦èˆ‡ Compose ç¶²æ®µä¸€è‡´ï¼›\\\`ue.yaml\\\` çš„ DNN/PLMN èˆ‡ SMF/AMF ç›¸ç¬¦ã€‚  

---

## 8) åƒè€ƒ minimal ç‰‡æ®µï¼ˆåƒ…ç¤ºæ„ï¼‰

> å¯¦éš›ä»¥ä½ çš„ \\\`deploy_exercise.yaml\\\` ç‚ºæº–ï¼Œä»¥ä¸‹åªæ¨™ç¤ºé—œéµä½å€èˆ‡ç¶²è·¯ã€‚

\`\`\`yaml
networks:
  privnet: { ipam: { config: [ { subnet: 10.100.200.0/24 } ] } }
  n2net:   { ipam: { config: [ { subnet: 10.100.2.0/24   } ] } }
  n3net:   { ipam: { config: [ { subnet: 10.100.3.0/24   } ] } }
  n4net:   { ipam: { config: [ { subnet: 10.100.4.0/24   } ] } }
  n6net:   { ipam: { config: [ { subnet: 10.100.6.0/24   } ] } }

services:
  db:
    image: mongo:4.4
    networks: { privnet: { ipv4_address: 10.100.200.10 } }

  nrf:
    networks: { privnet: { ipv4_address: 10.100.200.11 } }

  amf:
    networks:
      privnet: { ipv4_address: 10.100.200.21 }
      n2net:   { ipv4_address: 10.100.2.20  }

  smf:
    networks:
      privnet: { ipv4_address: 10.100.200.31 }
      n4net:   { ipv4_address: 10.100.4.20  }

  upf:
    networks:
      n3net: { ipv4_address: 10.100.3.100 }
      n4net: { ipv4_address: 10.100.4.100 }
      n6net: { ipv4_address: 10.100.6.100 }

  n6gw:
    networks:
      n6net: { ipv4_address: 10.100.6.101 }
\`\`\`

---

## 9) å°çµï¼ˆLearningsï¼‰

- **æ ¸å¿ƒä¾è³´å„ªå…ˆ**ï¼šDB æ›æ‰æœƒè®“æ•´å€‹ SBA æœå‹™éˆä¸€é€£ä¸² 500ï¼›å…ˆçœ‹ MongoDBã€å†çœ‹ NRFã€‚  
- **æ¬Šé™èˆ‡è¡Œå°¾**ï¼šåœ¨å®¹å™¨å…§åŸ·è¡Œè…³æœ¬æ™‚ï¼Œ\\\`+x\\\` èˆ‡ LF å¾ˆé—œéµï¼›Permission denied/126 å¹¾ä¹éƒ½æ˜¯é€™å€‹ã€‚  
- **ç¶²è·¯èˆ‡è·¯ç”±**ï¼šUPF/N6GW çš„é è¨­è·¯ç”±èˆ‡ SNAT æ±ºå®š UE æ˜¯å¦èƒ½å‡ºç¶²ï¼›N2/N3/N4 æ­£å¸¸ä¸ä»£è¡¨ N6 OKã€‚  
- **æ—¥èªŒå®šä½**ï¼š\\\`server selection timeout\\\` å¹¾ä¹ç›´æŒ‡ DBï¼Œ\\\`can not select AUSF\\\` å¤šåŠæ˜¯ NRF/DB å•é¡Œé€ æˆçš„ç™¼ç¾å¤±æ•—ã€‚  

---
`
},


// *******************************************************************
  // *******************************************************************
  // *******************************************************************
  // *******************************************************************

];


